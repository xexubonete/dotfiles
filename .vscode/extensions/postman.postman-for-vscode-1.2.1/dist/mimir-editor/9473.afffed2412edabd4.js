"use strict";(self.webpackChunkmimir_editor=self.webpackChunkmimir_editor||[]).push([[9473],{39473:(e,t,n)=>{n.r(t),n.d(t,{MimirEditor:()=>Rr,default:()=>wr});var o=n(40540),r=n.n(o),l=n(22833),i=n.n(l),s=n(69179),a=n(21121),c=n(21519),d=n(13917),u=n.n(d),E=n(49710),m=n.n(E);function p(e="",t){const n=null!=t&&t.inline?{allowedTags:["a","b","i","strong","em","strike","br","s","del","code"],allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"],video:["src","srcset","alt","title","width","height"],"*":["class"]}}:{allowedTags:["h1","h2","h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","img","abbr","address","section","article","aside","dd","dl","dt","tfoot","s","del","comment","u","video"],allowedAttributes:{a:["href"],img:["src","width","height","class","alt"],video:["src","width","height","class","alt"],div:["class"],pre:["class"],h1:["id"],"*":["class"]}};return e=e.replace(/<!--/g,"<comment>").replace(/-->/g,"</comment>").replace(/<p><video/gi,"<video").replace(/<\/video><\/p>/gi,"</video>"),m()(e,n)}function h(e,t,n){if("string"!=typeof e)return"";const o={gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1};for(const e of Object.keys(t||{}))o[e]=t[e];return u().setOptions(o),p(u()(e),n||{})}const f="context-view",g={MAX_FILE_SIZE:5242880,MAX_ALLOWED_FILE_NAME_LENGTH:100,MIN_USAGE_PERCENTAGE_WARNING:90,ALLOWED_FILE_FORMATS:["image"],ALLOWED_FILE_TYPES:["png","jpeg","jpg","gif","svg+xml"],INVALID_FILE_NAME_REGEX:new RegExp(/^.*["*/:<>?\\|]+.*$/)},T="Couldn't upload. Try again.",N="Unsupported file. Try uploading a PNG, JPG, SVG, or GIF file.",y="Couldn't upload. Please upload a file less than 5 MB.",_="Couldn't upload. Please make sure the filename is less than 100 characters.",L="Couldn't upload. Please make sure the filename doesn't contain special characters.",b="You don't have enough storage to upload the file.",M="Couldn't upload. Unsupported image type.",v={VIDEO_EMBED:"video_embed",SUPPORTED_SOURCES:["youtube","vimeo"],SUPPORTED_SOURCES_ATTRIBUTES:{YOUTUBE:{source:"youtube",EmbedUrlRegex:new RegExp(/^(https:\/\/)((www\.)?(youtube\.com))\/embed\/[\S\s]+$/),normalUrlRegex:new RegExp(/^(https:\/\/)((www\.)?(youtube\.com))\/watch\?v=[\S\s]+$/),embedUrlPrefix:"https://youtube.com/embed/"},VIMEO:{source:"vimeo",EmbedUrlRegex:new RegExp(/^(https:\/\/)((www\.)?(player\.vimeo\.com))\/video\/[\S\s]+$/),normalUrlRegex:new RegExp(/^(https:\/\/)((www\.)?(vimeo\.com))\/[\S\s]+$/),embedUrlPrefix:"https://player.vimeo.com/video/"}}},A={LINK:{ADD:"LINK_ADD",UPDATE:"LINK_UPDATE",EDIT:"LINK_EDIT"},IMAGE:{ADD:"IMAGE_ADD",UPDATE:"IMAGE_UPDATE",EDIT:"IMAGE_EDIT"},TABLE:{EDIT:"TABLE_EDIT"},MEDIA:{ADD:"MEDIA_ADD",UPDATE:"MEDIA_UPDATE",EDIT:"MEDIA_EDIT"},CLOSE:"CLOSE"};var x=n(7560),I=n(95658),C=n.n(I),k=n(3860),D=n.n(k);n(25483);const R=(e,t,n,o)=>r=>{e((e=>{e.noDiff=!0,e[t]!==r&&(e.noDiff=!1,e.actionType=n,e[t]=o?(0,x.Z)({},e[t],r):r)}))},w=(P=e=>(t,n,o)=>e((e=>t(D()(e))),n,o),B=C(),e=>B(P(e)))((e=>({isLinkOpen:!1,setIsLinkOpen:R(e,"isLinkOpen","setIsLinkOpen"),balloonState:A.CLOSE,setBalloonState:R(e,"balloonState","setBalloonState"),isTableBalloonOpen:!1,setIsTableOpen:R(e,"isTableOpen","setIsTableOpen"),editorSelection:null,setEditorSelection:R(e,"editorSelection","setEditorSelection"),editorSelectionText:null,setEditorSelectionText:R(e,"editorSelectionText","setEditorSelectionText"),nodeType:null,setNodeType:R(e,"nodeType","setNodeType"),isMediaUploading:null,setIsMediaUploading:R(e,"isMediaUploading","setIsMediaUploading")})));var P,B,S=n(52322);const j=({isAPIAuthEditor:e,source:t,editorId:n,isVideoEmbedEnabled:l})=>{const[i,s]=(0,o.useState)("full-size"),c=(0,a.usePlateEditorState)(n),[d,u]=(0,o.useState)(a.ELEMENT_DEFAULT),E=w((0,o.useCallback)((e=>e.setNodeType),[])),m=w((0,o.useCallback)((e=>e.balloonState),[])),p=w((0,o.useCallback)((e=>e.setBalloonState),[]));let h=0,g=0;return(0,o.useEffect)((()=>()=>{E(a.ELEMENT_DEFAULT)}),[]),(0,o.useEffect)((()=>{if(c&&c.selection){const e=c.children[c.selection.anchor.path[0]];u(e.type||a.ELEMENT_DEFAULT);let t=e.type;(0,a.getAbove)(c,{match:{type:(0,a.getPluginType)(c,a.ELEMENT_LINK)}})?t="link":(0,a.getAbove)(c,{match:{type:(0,a.getPluginType)(c,a.ELEMENT_IMAGE)}})?t="img":(0,a.getAbove)(c,{match:{type:(0,a.getPluginType)(c,a.ELEMENT_TABLE)}})?t="table":(0,a.getAbove)(c,{match:{type:(0,a.getPluginType)(c,a.ELEMENT_MEDIA_EMBED)}})&&(t=a.ELEMENT_MEDIA_EMBED),E(t||a.ELEMENT_DEFAULT)}}),[c&&c.selection,c&&c.children]),(0,o.useEffect)((()=>{const e=document.querySelector(`#mimir-${n}`),o=new ResizeObserver((e=>{return n=e[0].contentRect.width,o=e[0].contentRect.height,s(t===f?n<=370?"truncated-level-3":n<=440?"truncated-level-2":n<=480?"truncated-level-1":"full-size":n<=440?"truncated-level-3":n<=500?"truncated-level-2":n<=530?"truncated-level-1":"full-size"),void(h===n&&g===o||(0!==h&&0!==g&&m!==A.CLOSE&&p(A.CLOSE),h=n,g=o));var n,o}));return o.observe(e),()=>{o.unobserve(e)}}),[m,t]),e?(0,S.jsx)("header",{className:"toolbar__wrapper",children:(0,S.jsxs)("div",{className:"toolbar__list",children:[(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(re,{currentNodeType:d,isAPIAuthEditor:e,editorId:n})}),(0,S.jsx)("div",{className:"toolbar__list__divider--vertical"}),(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(ue,{currentNodeType:d,editorId:n})}),(0,S.jsx)("div",{className:"toolbar__list__divider--vertical"}),(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(ae,{currentNodeType:d,editorId:n})})]})}):(0,S.jsx)("header",{className:"toolbar__wrapper",children:(0,S.jsxs)("div",{className:"toolbar__list",children:[(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(We,{type:i,currentNodeType:d,editorId:n})}),(0,S.jsx)("div",{className:"toolbar__list__divider--vertical"}),(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(re,{currentNodeType:d,editorId:n})}),(0,S.jsx)("div",{className:"toolbar__list__divider--vertical"}),(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(ue,{currentNodeType:d,editorId:n})}),(0,S.jsx)("div",{className:"toolbar__list__divider--vertical"}),"truncated-level-3"===i?(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(Ae,{type:i,currentNodeType:d,editorId:n,isVideoEmbedEnabled:l})}):(0,S.jsxs)(r().Fragment,{children:[(0,S.jsxs)("div",{className:"toolbar__list__item",children:[(0,S.jsx)(Ae,{currentNodeType:d,editorId:n}),(0,S.jsx)(Ie,{currentNodeType:d}),l&&(0,S.jsx)(ke,{currentNodeType:d}),(0,S.jsx)(ae,{currentNodeType:d,editorId:n})]}),(0,S.jsx)("div",{className:"toolbar__list__item",children:(0,S.jsx)(Pe,{type:i,currentNodeType:d,editorId:n})})]})]})})};var O=n(35834),H=n(73213),U=n(40983);const K={[a.ELEMENT_CODE_BLOCK]:{[a.ELEMENT_DEFAULT]:!0,[a.ELEMENT_H1]:!0,[a.ELEMENT_H2]:!0,[a.ELEMENT_H3]:!0,[a.ELEMENT_H4]:!0,[a.ELEMENT_H5]:!0,[a.ELEMENT_H6]:!0,[a.ELEMENT_LI]:!0,[a.ELEMENT_UL]:!0,[a.ELEMENT_OL]:!0,[a.ELEMENT_CODE_LINE]:!0,[a.MARK_BOLD]:!0,[a.MARK_ITALIC]:!0,[a.MARK_STRIKETHROUGH]:!0,[a.MARK_CODE]:!0,[a.ELEMENT_TABLE]:!0,[a.ELEMENT_TH]:!0,[a.ELEMENT_IMAGE]:!0,[a.ELEMENT_MEDIA_EMBED]:!0,[a.ELEMENT_LINK]:!0,[a.ELEMENT_BLOCKQUOTE]:!0,[a.ELEMENT_HR]:!0},[a.ELEMENT_DEFAULT]:{[a.ELEMENT_H1]:!1,[a.ELEMENT_H2]:!1,[a.ELEMENT_H3]:!1,[a.ELEMENT_H4]:!1,[a.ELEMENT_H5]:!1,[a.ELEMENT_H6]:!1,[a.ELEMENT_LI]:!1,[a.ELEMENT_UL]:!1,[a.ELEMENT_OL]:!1,[a.ELEMENT_CODE_LINE]:!1,[a.MARK_BOLD]:!1,[a.MARK_ITALIC]:!1,[a.MARK_STRIKETHROUGH]:!1,[a.MARK_CODE]:!1,[a.ELEMENT_TABLE]:!1,[a.ELEMENT_TH]:!1,[a.ELEMENT_CODE_BLOCK]:!1,[a.ELEMENT_BLOCKQUOTE]:!1,[a.ELEMENT_HR]:!1},[a.ELEMENT_TABLE]:{[a.ELEMENT_DEFAULT]:!0,[a.ELEMENT_H1]:!0,[a.ELEMENT_H2]:!0,[a.ELEMENT_H3]:!0,[a.ELEMENT_H4]:!0,[a.ELEMENT_H5]:!0,[a.ELEMENT_H6]:!0,[a.ELEMENT_LI]:!0,[a.ELEMENT_UL]:!0,[a.ELEMENT_OL]:!0,[a.MARK_BOLD]:!1,[a.MARK_ITALIC]:!1,[a.MARK_STRIKETHROUGH]:!1,[a.MARK_CODE]:!1,[a.ELEMENT_CODE_BLOCK]:!0,[a.ELEMENT_TH]:!1,[a.ELEMENT_TABLE]:!0,[a.ELEMENT_IMAGE]:!0,[a.ELEMENT_MEDIA_EMBED]:!0,[a.ELEMENT_LINK]:!1,[a.ELEMENT_BLOCKQUOTE]:!0,[a.ELEMENT_HR]:!0},[a.ELEMENT_BLOCKQUOTE]:{[a.ELEMENT_DEFAULT]:!0,[a.ELEMENT_H1]:!0,[a.ELEMENT_H2]:!0,[a.ELEMENT_H3]:!0,[a.ELEMENT_H4]:!0,[a.ELEMENT_H5]:!0,[a.ELEMENT_H6]:!0,[a.ELEMENT_LI]:!0,[a.ELEMENT_UL]:!0,[a.ELEMENT_OL]:!0,[a.MARK_BOLD]:!1,[a.MARK_ITALIC]:!1,[a.MARK_STRIKETHROUGH]:!1,[a.MARK_CODE]:!1,[a.ELEMENT_CODE_BLOCK]:!0,[a.ELEMENT_IMAGE]:!0,[a.ELEMENT_MEDIA_EMBED]:!0,[a.ELEMENT_LINK]:!0,[a.ELEMENT_TABLE]:!0,[a.ELEMENT_BLOCKQUOTE]:!1,[a.ELEMENT_HR]:!0},[a.ELEMENT_UL]:{[a.ELEMENT_DEFAULT]:!0,[a.ELEMENT_H1]:!0,[a.ELEMENT_H2]:!0,[a.ELEMENT_H3]:!0,[a.ELEMENT_H4]:!0,[a.ELEMENT_H5]:!0,[a.ELEMENT_H6]:!0,[a.ELEMENT_LI]:!0,[a.ELEMENT_BLOCKQUOTE]:!0,[a.ELEMENT_OL]:!0,[a.MARK_BOLD]:!1,[a.MARK_ITALIC]:!1,[a.MARK_STRIKETHROUGH]:!1,[a.MARK_CODE]:!1,[a.ELEMENT_CODE_BLOCK]:!0,[a.ELEMENT_IMAGE]:!0,[a.ELEMENT_MEDIA_EMBED]:!0,[a.ELEMENT_LINK]:!1,[a.ELEMENT_TABLE]:!0,[a.ELEMENT_HR]:!0},[a.ELEMENT_OL]:{[a.ELEMENT_DEFAULT]:!0,[a.ELEMENT_H1]:!0,[a.ELEMENT_H2]:!0,[a.ELEMENT_H3]:!0,[a.ELEMENT_H4]:!0,[a.ELEMENT_H5]:!0,[a.ELEMENT_H6]:!0,[a.ELEMENT_LI]:!0,[a.ELEMENT_BLOCKQUOTE]:!0,[a.ELEMENT_UL]:!0,[a.MARK_BOLD]:!1,[a.MARK_ITALIC]:!1,[a.MARK_STRIKETHROUGH]:!1,[a.MARK_CODE]:!1,[a.ELEMENT_CODE_BLOCK]:!0,[a.ELEMENT_IMAGE]:!0,[a.ELEMENT_MEDIA_EMBED]:!0,[a.ELEMENT_LINK]:!1,[a.ELEMENT_TABLE]:!0,[a.ELEMENT_HR]:!0},[a.MARK_CODE]:{[a.ELEMENT_DEFAULT]:!1,[a.ELEMENT_H1]:!1,[a.ELEMENT_H2]:!1,[a.ELEMENT_H3]:!1,[a.ELEMENT_H4]:!1,[a.ELEMENT_H5]:!1,[a.ELEMENT_H6]:!1,[a.ELEMENT_LI]:!0,[a.ELEMENT_BLOCKQUOTE]:!0,[a.ELEMENT_UL]:!0,[a.MARK_BOLD]:!1,[a.MARK_ITALIC]:!1,[a.MARK_STRIKETHROUGH]:!1,[a.MARK_CODE]:!1,[a.ELEMENT_CODE_BLOCK]:!0,[a.ELEMENT_IMAGE]:!0,[a.ELEMENT_MEDIA_EMBED]:!0,[a.ELEMENT_LINK]:!0,[a.ELEMENT_TABLE]:!0,[a.ELEMENT_HR]:!0,[a.ELEMENT_OL]:!0}};var Z=n(98283),F=n(41007);const $=(0,a.createPluginFactory)({key:a.ELEMENT_CODE_BLOCK,isElement:!0,deserializeHtml:(0,x.Z)({},a.deserializeHtmlCodeBlock,{validNodeName:"PRE"}),handlers:{onKeyDown:a.onKeyDownCodeBlock},withOverrides:e=>{const{insertBreak:t,deleteBackward:n,selection:o}=e;return e.insertBreak=()=>{(()=>{if(!o)return;const t=(0,a.getCodeLineEntry)(e,{});if(!t)return;const{codeBlock:n,codeLine:r}=t,l=(0,a.getIndentDepth)(e,{codeBlock:n,codeLine:r});return(0,a.insertCodeLine)(e,l),!0})()||t()},e.insertFragment=(0,a.insertFragmentCodeBlock)(e),e.deleteBackward=t=>{if((0,a.isSelectionAtBlockStart)(e))try{const o=(0,a.getAbove)(e,{match:{type:[a.ELEMENT_CODE_LINE,a.ELEMENT_DEFAULT]}}),r=(0,a.getAbove)(e,{match:{type:[a.ELEMENT_CODE_BLOCK]}});r&&r[1]&&o&&0===o[1][1]?c.Transforms.removeNodes(e,{at:r[1]}):n(t)}catch(e){}else n(t)},e},options:{hotkey:["mod+opt+8","mod+shift+8"],syntax:!0,syntaxPopularFirst:!1},then:e=>({inject:{pluginsByKey:{[a.KEY_DESERIALIZE_HTML]:{editor:{insertData:{query:()=>{const t=(0,a.getPlugin)(e,a.ELEMENT_CODE_LINE);return!(0,a.someNode)(e,{match:{type:t.type}})}}}}}}}),plugins:[{key:a.ELEMENT_CODE_LINE,isElement:!0},{key:a.ELEMENT_CODE_SYNTAX,isLeaf:!0,decorate:a.decorateCodeLine}]}),G=(e,{defaultType:t=(0,a.getPluginType)(e,a.ELEMENT_DEFAULT),insertNodesOptions:n,level:o=0})=>{if(e.selection){if((0,a.isExpanded)(e.selection)||!(0,a.isSelectionAtBlockStart)(e)){const n=c.Editor.path(e,e.selection),r=c.Path.next(n.slice(0,o+1));c.Transforms.splitNodes(e,{at:e.selection}),(0,a.insertNodes)(e,{type:t,children:[{text:""}]},{at:r,select:!0})}else(0,a.isSelectionAtBlockEnd)(e)||(0,a.insertNodes)(e,{type:t,children:[{text:""}]});((e,t={})=>{e.selection&&!(0,a.isExpanded)(e.selection)&&((0,a.someNode)(e,{match:t=>t.type===(0,a.getPluginType)(e,a.ELEMENT_CODE_BLOCK)||t.type===(0,a.getPluginType)(e,a.ELEMENT_CODE_LINE)})||((0,a.isSelectionAtBlockStart)(e)||e.insertBreak(),(0,a.setNodes)(e,{type:(0,a.getCodeLineType)(e),children:[{text:""}]},t),(0,a.wrapNodes)(e,{type:(0,a.getPluginType)(e,a.ELEMENT_CODE_BLOCK),children:[]},t)))})(e,n)}};var z=n(81397);const V=["disabled","label","shortcuts","direction"];function q(e){return t=>{let{disabled:n,label:l,shortcuts:i,direction:s="top"}=t,a=(0,Z.Z)(t,V);const[c,d]=(0,o.useState)(!1),u=(0,o.useRef)(null),E=navigator.platform.toUpperCase().includes("MAC"),{icon:m,className:p}=a,h=(0,o.useMemo)((()=>{var e;return null!=(e=null==i?void 0:i.map(((e,t)=>{let n;switch(e){case"cmd":n=E?"⌘":"Ctrl";break;case"option":n=E?"⌥":"Alt";break;case"shift":n="⇧";break;default:n=e}return 0===t?n:" "+n})))?e:[]}),[E,i]),f=(0,o.useMemo)((()=>l?m:(0,S.jsxs)("div",{className:"toolbar-dropdown-icon",children:[(0,S.jsx)("div",{children:m}),(0,S.jsx)("div",{className:"toolbar-dropdown-shortcut-label",children:h})]})),[h,l]),g=(0,o.useMemo)((()=>(0,S.jsxs)("div",{style:{textAlign:"center"},children:[l,h.length>0&&(0,S.jsxs)("label",{className:"toolbar-shortcut-label",children:[(0,S.jsx)("br",{}),h.join(" ")]})]})),[l,h]);return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)("div",{className:"slate-toolbar-button-wrapper",onMouseEnter:()=>{d(!0)},onMouseLeave:()=>{d(!1)},ref:u,children:n?(0,S.jsx)("span",{className:`${p} toolbar-button--disabled`,children:f}):(0,S.jsx)(e,(0,x.Z)({},a,{icon:f}))}),l&&(0,S.jsx)(z.Z,{openDelay:100,placement:s,triggerRef:u,className:"slate-toolbar-tooltip",isOpen:c&&!n,content:g})]})}}const W=["type"],Y=["type","clear"],Q=["type","inactiveType"],X=["options"],J=(0,S.jsx)(S.Fragment,{}),ee=q((e=>{let{type:t,inactiveType:n}=e,o=(0,Z.Z)(e,Q);const r=(0,a.usePlateEditorState)(o.editorId);return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:r&&r.selection&&(0,a.someNode)(r,{match:{type:t}}),onMouseDown:e=>{e.preventDefault(),F.ReactEditor.focus(r),(0,a.toggleNodeType)(r,{activeType:t,inactiveType:n})},icon:J},o))})),te=q((e=>{let{type:t,clear:n}=e,o=(0,Z.Z)(e,Y);const r=(0,a.usePlateEditorState)(null==o?void 0:o.editorId);return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:r&&r.selection&&(0,a.isMarkActive)(r,t),onMouseDown:e=>{e.preventDefault(),F.ReactEditor.focus(r),(0,a.toggleMark)(r,{key:t,clear:n})},icon:J},o))})),ne=q((e=>{let{options:t}=e,n=(0,Z.Z)(e,X);const o=(0,a.usePlateEditorState)(null==n?void 0:n.editorId);return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:o&&o.selection&&(0,a.someNode)(o,{match:{type:a.ELEMENT_CODE_BLOCK}}),onMouseDown:e=>{e.preventDefault(),F.ReactEditor.focus(o),G(o,(0,x.Z)({insertNodesOptions:{select:!0}},t))},icon:J},n))})),oe=q((e=>{let{type:t=a.ELEMENT_UL}=e,n=(0,Z.Z)(e,W);const o=(0,a.usePlateEditorState)(n.editorId);return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:o&&o.selection&&(0,a.someNode)(o,{match:{type:t}}),onMouseDown:e=>{e.preventDefault(),F.ReactEditor.focus(o),(0,a.toggleList)(o,{type:t})},icon:J},n))})),re=(q(a.ToolbarButton),({currentNodeType:e,editorId:t})=>{const n=(0,a.usePlateEditorState)(t);if(!n)return null;const o=K[e],l=c.Editor.marks(n),i=l&&l[a.MARK_CODE];return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(te,{className:"toolbar__icon",type:(0,a.getPluginType)(n,a.MARK_BOLD),icon:(0,S.jsx)(O.Z,{}),label:"Bold",shortcuts:["cmd","B"],disabled:!!o&&(o[a.MARK_BOLD]||i),editorId:t})}),(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(te,{className:"toolbar__icon",type:(0,a.getPluginType)(n,a.MARK_ITALIC),icon:(0,S.jsx)(H.Z,{}),label:"Italic",shortcuts:["cmd","I"],disabled:!!o&&(o[a.MARK_ITALIC]||i),editorId:t})}),(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(te,{className:"toolbar__icon",type:(0,a.getPluginType)(n,a.MARK_STRIKETHROUGH),icon:(0,S.jsx)(U.Z,{}),label:"Strikethrough",shortcuts:["option","shift","X"],disabled:!!o&&(o[a.MARK_STRIKETHROUGH]||i),editorId:t})})]})});var le=n(95617),ie=n(5858);const se=q((e=>{let t=(0,x.Z)({},((0,ie.Z)(e),e));const n=w((0,o.useCallback)((e=>e.balloonState),[])),r=w((0,o.useCallback)((e=>e.setBalloonState),[])),l="link"===w((0,o.useCallback)((e=>e.nodeType),[]));return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:l,onMouseDown:()=>{n.includes("LINK")&&n===A.LINK.EDIT?r(A.CLOSE):r(A.LINK.ADD)},icon:""},t))})),ae=({currentNodeType:e,editorId:t})=>{const n=K[e],o=(0,a.usePlateEditorState)(t),r=o&&c.Editor.marks(o);let l=!!n&&n[a.ELEMENT_LINK];return l=l||r&&r[a.MARK_CODE],(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(se,{className:"toolbar__icon",icon:(0,S.jsx)(le.Z,{}),label:"Link",shortcuts:["option","shift","K"],disabled:l})})};var ce=n(39257),de=n(42856);const ue=({currentNodeType:e,editorId:t})=>{const n=(0,a.usePlateEditorState)(t),o=K[e];return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(oe,{className:"toolbar__icon",type:(0,a.getPluginType)(n,a.ELEMENT_UL),icon:(0,S.jsx)(ce.Z,{}),label:"Unordered List",disabled:!!o&&o[a.ELEMENT_UL],editorId:t})}),(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(oe,{className:"toolbar__icon",type:(0,a.getPluginType)(n,a.ELEMENT_OL),icon:(0,S.jsx)(de.Z,{}),label:"Ordered List",disabled:!!o&&o[a.ELEMENT_OL],editorId:t})})]})},Ee={type:"p",children:[{text:""}]};function me(){return(0,x.Z)({},JSON.parse(JSON.stringify(Ee)))}const pe=(e,{header:t})=>t?{type:(0,a.getPluginType)(e,a.ELEMENT_TH),children:[{text:"",bold:!0}]}:{type:(0,a.getPluginType)(e,a.ELEMENT_TD),children:[{text:""}]},he=(e,{header:t,colCount:n})=>({type:(0,a.getPluginType)(e,a.ELEMENT_TR),children:Array.from({length:n}).map((()=>pe(e,{header:t})))}),fe=(e,{header:t}={})=>{if(!(0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}})){(0,a.insertNodes)(e,((e,{header:t})=>({type:(0,a.getPluginType)(e,a.ELEMENT_TABLE),children:[he(e,{header:!0,colCount:2}),he(e,{header:t,colCount:2})]}))(e,{header:t}));const n=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}}),[,o]=n;c.Transforms.select(e,o),c.Transforms.collapse(e,{edge:"start"})}},ge=(e,{at:t=e.selection}={})=>{if(t&&(0,a.someNode)(e,{at:t,match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TD),(0,a.getPluginType)(e,a.ELEMENT_TH)]}})){const n=(0,a.getParent)(e,t);if(!n)return;const[,o]=n,r=(0,a.getAbove)(e,{at:t,match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TD),(0,a.getPluginType)(e,a.ELEMENT_TH)]}})||(0,a.getParent)(e,o);if(!r)return;const[l,i]=r;if(![(0,a.getPluginType)(e,a.ELEMENT_TD),(0,a.getPluginType)(e,a.ELEMENT_TH)].includes(l.type))return;const s=(0,a.getParent)(e,i);if(!s)return;const[c,d]=s;if(c.type!==(0,a.getPluginType)(e,a.ELEMENT_TR))return;const u=(0,a.getParent)(e,d);if(!u)return;return{tableElement:u,tableRow:s,tableCell:r}}},Te=((0,a.createPluginFactory)({key:a.ELEMENT_TABLE,isElement:!0,handlers:{onKeyDown:e=>t=>{switch(t.key){case"Tab":{t.preventDefault();const n=ge(e,{});if(!n)return;const{tableElement:o,tableRow:r,tableCell:l}=n,[,i]=l,[s]=o,d=F.ReactEditor.toDOMNode(e,s),u=t.shiftKey,E=!t.shiftKey;if(u){const t=(0,a.getPreviousTableCell)(e,l,i,r);if(t){const[,n]=t;c.Transforms.select(e,n),i[1]===n[1]?d&&d.scrollBy(-110,0):d&&d.scrollBy(9999,0),c.Transforms.collapse(e,{edge:"end"})}}else if(E){const t=(0,a.getNextTableCell)(e,l,i,r);if(t){const[,n]=t;c.Transforms.select(e,n),i[1]===n[1]?d&&d.scrollBy(110,0):d&&(d.scrollLeft=0),c.Transforms.collapse(e,{edge:"end"})}}break}case"ArrowUp":{const t=(0,a.getAbove)(e,{match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TH),(0,a.getPluginType)(e,a.ELEMENT_TD)]}}),n=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}});if(t&&n){const[o,r,...l]=t[1];setTimeout((()=>{try{0===r?c.Transforms.select(e,c.Path.previous(n[1])):c.Transforms.select(e,[o,r-1,...l]),c.Transforms.collapse(e,{edge:"start"})}catch(e){}}))}break}case"ArrowDown":{const t=(0,a.getAbove)(e,{match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TH),(0,a.getPluginType)(e,a.ELEMENT_TD)]}}),n=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}});if(t&&n){const[o,r,...l]=t[1];setTimeout((()=>{const t=[o,r+1,...l];try{(0,a.someNode)(e,{at:t,match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TD)]}})?c.Transforms.select(e,t):c.Transforms.select(e,c.Path.next(n[1])),c.Transforms.collapse(e,{edge:"start"})}catch(e){}}))}break}default:if("Enter"===t.key&&!t.metaKey){const n=(0,a.getAbove)(e,{match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TH),(0,a.getPluginType)(e,a.ELEMENT_TD)]}}),o=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}});n&&o&&(c.Transforms.insertText(e,"\n"),t.preventDefault(),t.stopPropagation())}}}},deserializeHtml:{validNodeName:"TABLE"},withOverrides:e=>{const t=t=>(0,a.isElement)(t)&&(t.type===(0,a.getPluginType)(e,a.ELEMENT_TD)||t.type===(0,a.getPluginType)(e,a.ELEMENT_TH)),{deleteBackward:n,deleteForward:o,deleteFragment:r,insertText:l}=e,i=(n,o,r)=>l=>{const{selection:i}=e;if((0,a.isCollapsed)(i)){const[n]=c.Editor.nodes(e,{match:t});if(n){const[,t]=n,r=o(e,t);if(i&&c.Point.equals(i.anchor,r))return}else{const n=r(e,i,{unit:l}),[o]=c.Editor.nodes(e,{match:t,at:n});if(o){c.Transforms.select(e,n);const t=ge(e,{at:n});if(!t)return;const{tableElement:o,tableCell:r}=t,[,l]=r,[s]=o,d=F.ReactEditor.toDOMNode(e,s);return l&&l[2]&&0!==l[2]?d&&d.scrollBy(9999,0):d&&(d.scrollLeft=0),void c.Transforms.removeNodes(e,{at:i,match:e=>e.type===a.ELEMENT_UL||e.type===a.ELEMENT_OL||e.type===a.ELEMENT_CODE_BLOCK})}}}n(l)};return e.deleteFragment=()=>{const{selection:n}=e,[o]=c.Editor.nodes(e,{match:t,at:null==n?void 0:n.anchor.path}),[l]=c.Editor.nodes(e,{match:t,at:null==n?void 0:n.focus.path});if(!o&&!l||(null==o?void 0:o[0])===(null==l?void 0:l[0]))r();else{const n=c.Editor.nodes(e,{match:t});for(const[,t]of n)for(const[,n]of c.Node.children(e,t,{reverse:!0}))c.Transforms.removeNodes(e,{at:n});c.Transforms.collapse(e)}},e.insertText=n=>{const{selection:o}=e,[r]=c.Editor.nodes(e,{match:t,at:null==o?void 0:o.anchor.path}),[i]=c.Editor.nodes(e,{match:t,at:null==o?void 0:o.focus.path});if(!(0,a.isCollapsed)(o)&&(r||i)&&(null==r?void 0:r[0])!==(null==i?void 0:i[0])){const[o]=c.Editor.nodes(e,{match:t});if(o)return c.Transforms.collapse(e,{edge:"end"}),void l(n)}l(n)},e.deleteBackward=i(n,c.Editor.start,c.Editor.before),e.deleteForward=i(o,c.Editor.end,c.Editor.after),e},plugins:[{key:a.ELEMENT_TR,isElement:!0,deserializeHtml:{validNodeName:"TR"}},{key:a.ELEMENT_TD,isElement:!0,deserializeHtml:{validNodeName:"TD"}},{key:a.ELEMENT_TH,isElement:!0,deserializeHtml:{validNodeName:"TH"}}]}),["transform","header"]),Ne=e=>{let{transform:t,header:n}=e,o=(0,Z.Z)(e,Te);const r=(0,a.usePlateEditorState)(null==o?void 0:o.editorId),l=(0,a.getPluginType)(r,a.ELEMENT_TABLE),i=w((e=>e.nodeType))===a.ELEMENT_TABLE;return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:i,onMouseDown:e=>{l&&r&&(e.preventDefault(),t(r,{header:n}),F.ReactEditor.focus(r))}},o))},ye=q(Ne);var _e=n(29225),Le=n(80756);const be=q((e=>{let t=(0,x.Z)({},((0,ie.Z)(e),e));const n=w((0,o.useCallback)((e=>e.balloonState),[])),r=w((0,o.useCallback)((e=>e.setBalloonState),[])),l="img"===w((0,o.useCallback)((e=>e.nodeType),[]));return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:l,onMouseDown:()=>{n.includes("IMAGE")&&n===A.IMAGE.EDIT?r(A.CLOSE):r(A.IMAGE.ADD)},icon:(0,S.jsx)(S.Fragment,{})},t))})),Me=q((e=>{let t=(0,x.Z)({},((0,ie.Z)(e),e));const n=w((0,o.useCallback)((e=>e.balloonState),[])),r=w((0,o.useCallback)((e=>e.setBalloonState),[])),l=w((0,o.useCallback)((e=>e.nodeType),[]))===a.ELEMENT_MEDIA_EMBED;return(0,S.jsx)(a.ToolbarButton,(0,x.Z)({active:l,onMouseDown:()=>{n.includes("MEDIA")&&n===A.MEDIA.EDIT?r(A.CLOSE):r(A.MEDIA.ADD)},icon:{}},t))})),ve=(e,t)=>{(0,o.useEffect)((()=>{const t=t=>{"Escape"===t.code&&e()};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}}),t)},Ae=({type:e,currentNodeType:t,isVideoEmbedEnabled:n,editorId:r})=>{const[l,s]=(0,o.useState)(!1),d=(0,a.usePlateEditorState)(r),u=K[t],E=w((e=>e.editorSelection));ve((()=>{l&&(s(!1),c.Transforms.select(d,E),F.ReactEditor.focus(d))}),[d,E,l]);const m=e=>{u[e]||(s(!l),c.Transforms.select(d,E),F.ReactEditor.focus(d))};return"truncated-level-3"===e?(0,S.jsxs)("div",{tabIndex:0,onBlur:()=>{s(!1)},className:"toolbar__button",children:[(0,S.jsx)("div",{className:i()("toolbar__dropdown__menu","slate-ToolbarButton",{"toolbar__dropdown__menu--active":l}),onClick:()=>{s(!l)},children:(0,S.jsx)(_e.Z,{})}),l?(0,S.jsxs)("div",{className:"toolbar__dropdown table",children:[(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_TABLE)},children:(0,S.jsx)(ye,{className:"slate-ToolbarButton",icon:"Table",transform:fe,shortcuts:["option","shift","T"],disabled:!!u&&u[a.ELEMENT_TABLE]})},"table"),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_IMAGE)},children:(0,S.jsx)(be,{className:"slate-ToolbarButton",icon:"Image",disabled:!!u&&u[a.ELEMENT_IMAGE]})},"image"),n&&(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_MEDIA_EMBED)},children:(0,S.jsx)(Me,{className:"slate-ToolbarButton",icon:"Video",disabled:!!u&&u[a.ELEMENT_MEDIA_EMBED]})},"video"),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_LINK)},children:(0,S.jsx)(se,{className:"slate-ToolbarButton",icon:"Add link",disabled:!!u&&u[a.ELEMENT_LINK],shortcuts:["option","shift","K"]})},"link"),(0,S.jsx)("div",{className:"toolbar__list__divider--horizontal"}),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_BLOCKQUOTE)},children:(0,S.jsx)(ee,{className:"slate-ToolbarButton",type:(0,a.getPluginType)(d,a.ELEMENT_BLOCKQUOTE),icon:"Blockquote",disabled:!!u&&u[a.ELEMENT_BLOCKQUOTE],editorId:r})},"block-quote"),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.MARK_CODE)},children:(0,S.jsx)(te,{className:"slate-ToolbarButton",type:(0,a.getPluginType)(d,a.MARK_CODE),icon:"Codespan",disabled:!!u&&u[a.MARK_CODE],shortcuts:["option","shift","M"],editorId:r})},"code-span"),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_CODE_BLOCK)},children:(0,S.jsx)(ee,{className:"slate-ToolbarButton",type:(0,a.getPluginType)(d,a.ELEMENT_CODE_BLOCK),icon:"Codeblock",disabled:!!u&&u[a.ELEMENT_CODE_BLOCK],editorId:r})},"code-block")]}):null]}):(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(ye,{className:"toolbar__icon",icon:(0,S.jsx)(Le.Z,{}),transform:fe,label:"Table",shortcuts:["option","shift","T"],disabled:!!u&&u[a.ELEMENT_TABLE]})})};var xe=n(84858);const Ie=({currentNodeType:e})=>{const t=K[e];return(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(be,{className:"toolbar__icon",icon:(0,S.jsx)(xe.Z,{}),label:"Image",disabled:!!t&&t[a.ELEMENT_IMAGE]})})};var Ce=n(97913);const ke=({currentNodeType:e})=>{const t=K[e];return(0,S.jsx)("span",{className:"toolbar__button","data-testid":"toolbar-media-button",children:(0,S.jsx)(Me,{className:"toolbar__icon",icon:(0,S.jsx)(Ce.Z,{}),label:"Video",disabled:!!t&&t[a.ELEMENT_MEDIA_EMBED]})})};var De=n(4450),Re=n(20684),we=n(34267);const Pe=({type:e,currentNodeType:t,editorId:n})=>{const l=(0,a.usePlateEditorState)(n),[s,d]=(0,o.useState)(!1),u=K[t],E=w((e=>e.editorSelection));ve((()=>{s&&(d(!1),c.Transforms.select(l,E),F.ReactEditor.focus(l))}),[E,l,s]);const m=e=>{u[e]||(d(!s),c.Transforms.select(l,E),F.ReactEditor.focus(l))};return"full-size"===e||"truncated-level-1"===e?(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(ee,{className:"toolbar__icon",type:(0,a.getPluginType)(l,a.ELEMENT_BLOCKQUOTE),icon:(0,S.jsx)(De.Z,{}),label:"Blockquote",disabled:!!u&&u[a.ELEMENT_BLOCKQUOTE],editorId:n})}),(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(te,{className:"toolbar__icon",type:(0,a.getPluginType)(l,a.MARK_CODE),icon:(0,S.jsx)(Re.Z,{}),label:"Codespan",shortcuts:["option","shift","M"],disabled:!!u&&u[a.MARK_CODE],editorId:n})}),(0,S.jsx)("span",{className:"toolbar__button",children:(0,S.jsx)(ne,{className:"toolbar__icon",type:(0,a.getPluginType)(l,a.ELEMENT_CODE_BLOCK),icon:(0,S.jsx)(we.Z,{}),label:"Codeblock",disabled:!!u&&u[a.ELEMENT_CODE_BLOCK],editorId:n})})]}):(0,S.jsxs)("div",{tabIndex:0,onBlur:()=>{d(!1)},className:"toolbar__button",children:[(0,S.jsx)("div",{className:i()("toolbar__dropdown__menu","slate-ToolbarButton",{"toolbar__dropdown__menu--active":s}),onClick:()=>{d(!s)},children:(0,S.jsx)(_e.Z,{})}),s?(0,S.jsxs)("div",{className:"toolbar__dropdown code",children:[(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_BLOCKQUOTE)},children:(0,S.jsx)(ee,{type:(0,a.getPluginType)(l,a.ELEMENT_BLOCKQUOTE),icon:"Blockquote",className:"slate-ToolbarButton",disabled:!!u&&u[a.ELEMENT_BLOCKQUOTE],editorId:n})},"block-quote"),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.MARK_CODE)},children:(0,S.jsx)(te,{type:(0,a.getPluginType)(l,a.MARK_CODE),icon:"Codespan",className:"slate-ToolbarButton",disabled:!!u&&u[a.MARK_CODE],shortcuts:["option","shift","M"],editorId:n})},"code-span"),(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{m(a.ELEMENT_CODE_BLOCK)},children:(0,S.jsx)(ne,{className:"slate-ToolbarButton",type:(0,a.getPluginType)(l,a.ELEMENT_CODE_BLOCK),icon:"Codeblock",disabled:!!u&&u[a.ELEMENT_CODE_BLOCK],editorId:n})},"code-block")]}):null]})},Be=["size","className","icon","style"];function Se(e){const{size:t,className:n,icon:o,style:r}=e,l=(0,Z.Z)(e,Be),s=["pm-icon",{[`pm-icon-${t}`]:t,[`pm-icon-${r}`]:r},n];return o?(0,S.jsx)("i",(0,x.Z)({},l,{className:i()(...s),children:o})):null}Se.defaultProps={size:"sm",style:"normal"};const je=(0,S.jsx)("svg",{width:"8",height:"5",viewBox:"0 0 8 5",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.99954 2.9697L1.26471 0.23487L0.734375 0.7652L3.99954 4.03037L7.26471 0.7652L6.73438 0.23487L3.99954 2.9697Z",fill:"#6B6B6B"})}),Oe=function(e){return(0,S.jsx)(Se,(0,x.Z)({},e,{icon:je,size:"xs"}))},He=(0,S.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,S.jsx)("path",{d:"M1.5 1.00005L1.50003 5.00009C1.50003 5.27624 1.72389 5.50009 2.00003 5.50009H14C14.2762 5.50009 14.5 5.27623 14.5 5.00009L14.5 1",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M10.5 7.5L5.5 12.5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M5.5 7.5L10.5 12.5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M1.50003 7.00005V13C1.50003 13.8285 2.1716 14.5 3.00003 14.5H8.00003H13C13.8285 14.5 14.5 13.8285 14.5 13V7",stroke:"#6B6B6B",strokeDasharray:"1.8 1"})]});function Ue(){return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)(Se,{icon:He}),(0,S.jsx)("span",{className:"icon__label",children:"Delete row"})]})}const Ke=(0,S.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,S.jsx)("path",{d:"M1.5 1.00005L1.50003 5.00009C1.50003 5.27624 1.72389 5.50009 2.00003 5.50009H14C14.2762 5.50009 14.5 5.27623 14.5 5.00009L14.5 1",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M8 7V13",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M5 10H11",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M1.50003 7.00005V13C1.50003 13.8285 2.1716 14.5 3.00003 14.5H8.00003H13C13.8285 14.5 14.5 13.8285 14.5 13V7",stroke:"#6B6B6B",strokeDasharray:"1.8 1"})]});function Ze(){return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)(Se,{icon:Ke}),(0,S.jsx)("span",{className:"icon__label",children:"Add row"})]})}const Fe=(0,S.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,S.jsx)("path",{d:"M1.00005 14.5L5.00009 14.5C5.27624 14.5 5.50009 14.2761 5.50009 14L5.50009 1.99997C5.50009 1.72383 5.27623 1.49997 5.00009 1.49997L1 1.5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M7.5 5.5L12.5 10.5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M7.5 10.5L12.5 5.5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M7.00005 14.5H13C13.8285 14.5 14.5 13.8284 14.5 13V7.99997V2.99997C14.5 2.17154 13.8285 1.49997 13 1.49997H7",stroke:"#6B6B6B",strokeDasharray:"1.8 1"})]});function $e(){return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)(Se,{icon:Fe}),(0,S.jsx)("span",{className:"icon__label",children:"Delete column"})]})}const Ge=(0,S.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,S.jsx)("path",{d:"M1.00005 14.5L5.00009 14.5C5.27624 14.5 5.50009 14.2761 5.50009 14L5.50009 1.99997C5.50009 1.72383 5.27623 1.49997 5.00009 1.49997L1 1.5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M7 8H13",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M10 11V5",stroke:"#6B6B6B"}),(0,S.jsx)("path",{d:"M7.00005 14.5H13C13.8285 14.5 14.5 13.8284 14.5 13V7.99997V2.99997C14.5 2.17154 13.8285 1.49997 13 1.49997H7",stroke:"#6B6B6B",strokeDasharray:"1.8 1"})]});function ze(){return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)(Se,{icon:Ge}),(0,S.jsx)("span",{className:"icon__label",children:"Add column"})]})}const Ve=(0,S.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,S.jsx)("path",{d:"M6 0V1H2V2H14V1H10V0H6Z",fill:"#6B6B6B"}),(0,S.jsx)("path",{d:"M4 4V14.5C4 14.7761 4.22386 15 4.5 15H11.5C11.7761 15 12 14.7761 12 14.5V4H13V14.5C13 15.3284 12.3284 16 11.5 16H4.5C3.67157 16 3 15.3284 3 14.5V4H4Z",fill:"#6B6B6B"}),(0,S.jsx)("path",{d:"M6 13V4H7V13H6Z",fill:"#6B6B6B"}),(0,S.jsx)("path",{d:"M9 4V13H10V4H9Z",fill:"#6B6B6B"})]});function qe(){return(0,S.jsxs)(r().Fragment,{children:[(0,S.jsx)(Se,{icon:Ve}),(0,S.jsx)("span",{className:"icon__label",children:"Delete table"})]})}const We=({type:e,currentNodeType:t,editorId:n})=>{const r=(0,a.usePlateEditorState)(n),[l,s]=(0,o.useState)(0),[d,u]=(0,o.useState)(!1),[E,m]=(0,o.useState)(!1),p=K[t],h=w((e=>e.editorSelection)),f=[{value:a.ELEMENT_DEFAULT,icon:"Normal text","icon-truncated":"Aa",shortcuts:["option","shift","0"]},{value:a.ELEMENT_H1,icon:"Heading 1","icon-truncated":"H1",shortcuts:["option","shift","1"]},{value:a.ELEMENT_H2,icon:"Heading 2","icon-truncated":"H2",shortcuts:["option","shift","2"]},{value:a.ELEMENT_H3,icon:"Heading 3","icon-truncated":"H3",shortcuts:["option","shift","3"]},{value:a.ELEMENT_H4,icon:"Heading 4","icon-truncated":"H4",shortcuts:["option","shift","4"]},{value:a.ELEMENT_H5,icon:"Heading 5","icon-truncated":"H5",shortcuts:["option","shift","5"]},{value:a.ELEMENT_H6,icon:"Heading 6","icon-truncated":"H6",shortcuts:["option","shift","6"]}];return ve((()=>{d&&(u(!1),c.Transforms.select(r,h),F.ReactEditor.focus(r))}),[r,h,d]),(0,o.useEffect)((()=>{const e=f.findIndex((e=>e.value==t));s(-1==e?0:e);const n=f.every((e=>!!p&&p[e.value]));m(n)}),[t]),(0,S.jsxs)("div",{tabIndex:0,onBlur:()=>{u(!1)},children:[(0,S.jsxs)("div",{className:i()("toolbar__dropdown__heading",{"toolbar__dropdown__heading--disabled":E}),onClick:()=>{!E&&u(!d)},children:[(0,S.jsx)("div",{className:i()({"title__full-size":"full-size"===e,title__truncated:"full-size"!==e}),children:"full-size"===e?f[l].icon:f[l]["icon-truncated"]}),(0,S.jsx)(Oe,{className:"arrow__icon"})]}),d?(0,S.jsx)("div",{className:"toolbar__dropdown",children:f.map(((t,o)=>(0,S.jsx)("div",{className:"toolbar_dropdown-list",onClick:()=>{p&&p[t.value]||(u(!d),c.Transforms.select(r,h),F.ReactEditor.focus(r),s(o))},children:(0,S.jsx)(ee,{className:"slate-ToolbarButton",type:(0,a.getPluginType)(r,t.value),icon:"full-size"===e?t.icon:t["icon-truncated"],disabled:!!p&&p[t.value],inactiveType:l>=0&&l<f.length?f[l].value:void 0,shortcuts:t.shortcuts,editorId:n})},t.value)))}):null]})},Ye={MARKDOWN:"markdown",HTML:"html",SLATE:"slate"},Qe={WYSIWYG:"wysiwyg",PAGES:"pages",KNOWLEDGEBASE:"knowledge-base",DISCUSSIONS:"discussions"},Xe="Instant Markdown styling is supported. Try **bold**,  *italic*, or `inline code`",Je="ul",et="ol",tt="li",nt="p";var ot,rt,lt,it=Array.isArray,st=function(){if(0===arguments.length)return[];var e=arguments[0];return it(e)?e:[e]},at=(ot=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});for(var n="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),o={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},r={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:n?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},l={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=1;i<20;i++)l["f"+i]=111+i;function s(e,t,n){t&&!("byKey"in t)&&(n=t,t=null),Array.isArray(e)||(e=[e]);var o=e.map((function(e){return a(e,t)})),r=function(e){return o.some((function(t){return c(t,e)}))};return null==n?r:r(n)}function a(e,t){var n=t&&t.byKey,r={},l=(e=e.replace("++","+add")).split("+"),i=l.length;for(var s in o)r[o[s]]=!1;var a,c=!0,E=!1;try{for(var m,p=l[Symbol.iterator]();!(c=(m=p.next()).done);c=!0){var h=m.value,f=h.endsWith("?")&&h.length>1;f&&(h=h.slice(0,-1));var g=u(h),T=o[g];1!==i&&T||(n?r.key=g:r.which=d(h)),T&&(r[T]=!f||null)}}catch(e){E=!0,a=e}finally{try{!c&&p.return&&p.return()}finally{if(E)throw a}}return r}function c(e,t){for(var n in e){var o,r=e[n];if(null!=r&&(null!=(o="key"===n&&null!=t.key?t.key.toLowerCase():"which"===n?91===r&&93===t.which?91:t.which:t[n])||!1!==r)&&o!==r)return!1}return!0}function d(e){return e=u(e),l[e]||e.toUpperCase().codePointAt(0)}function u(e){return e=e.toLowerCase(),r[e]||e}t.default=s,t.isHotkey=s,t.isCodeHotkey=function(e,t){return s(e,t)},t.isKeyHotkey=function(e,t){return s(e,{byKey:!0},t)},t.parseHotkey=a,t.compareHotkey=c,t.toKeyCode=d,t.toKeyName=u},ot(rt={exports:{}},rt.exports),rt.exports),ct=(lt=at)&&lt.__esModule&&Object.prototype.hasOwnProperty.call(lt,"default")?lt.default:lt;at.isHotkey,at.isCodeHotkey,at.isKeyHotkey,at.parseHotkey,at.compareHotkey,at.toKeyCode,at.toKeyName;const dt=(e,t)=>{var n;const o=null===(n=(0,a.getParent)(e,t))||void 0===n?void 0:n[0];return(null==o?void 0:o.type)===(0,a.getPluginType)(e,tt)},ut=e=>[(0,a.getPluginType)(e,et),(0,a.getPluginType)(e,Je)],Et=(e,{list:t,listItem:n})=>{const[o]=t,[,r]=n;let l;try{l=c.Path.previous(r)}catch(e){return}const i=c.Editor.node(e,l);if(i){const[t,n]=i,l=t.children.find((t=>(0,a.match)(t,{type:ut(e)}))),s=n.concat(l?[1,l.children.length]:[1]);l||(0,a.wrapNodes)(e,{type:o.type,children:[]},{at:r}),c.Transforms.moveNodes(e,{at:r,to:s})}},mt=(e,t)=>t.children.some((t=>(0,a.match)(t,{type:ut(e)}))),pt=(e,{fromList:t,fromListItem:n,fromStartIndex:o,to:r,toList:l,toListIndex:i=null,deleteFromList:s=!0})=>{let d;if(n){const t=(0,a.findDescendant)(e,{at:n[1],match:{type:ut(e)}});if(!t)return 0;d=null==t?void 0:t[1]}else{if(!t)return;d=t[1]}let u=null;if(r&&(u=r),l)if(null===i){const e=(0,a.getLastChildPath)(l);u=c.Path.next(e)}else u=[...l[1],i];if(!u)return;const E=(0,a.moveChildren)(e,{at:d,to:u,fromStartIndex:o});return s&&c.Transforms.delete(e,{at:d}),E},ht=(e,{at:t}={})=>{(0,a.setNodes)(e,{type:(0,a.getPluginType)(e,a.ELEMENT_DEFAULT)},{at:t}),(0,a.unwrapNodes)(e,{at:t,match:{type:(0,a.getPluginType)(e,tt)}}),(0,a.unwrapNodes)(e,{at:t,match:{type:[(0,a.getPluginType)(e,Je),(0,a.getPluginType)(e,et)]},split:!0})},ft=(e,{list:t,listItem:n})=>{let o=!1;return c.Editor.withoutNormalizing(e,(()=>{o=(()=>{const[o,r]=t,[l,i]=n,s=(0,a.getAbove)(e,{at:r,match:{type:(0,a.getPluginType)(e,tt)}});if(!s){let s;try{s=c.Path.next(r)}catch(e){return}const d=mt(e,l),u=!(0,a.isLastChild)(t,i);if((d||u)&&(0,a.insertNodes)(e,{type:o.type,children:[]},{at:s}),d){const t=(0,a.getNode)(e,s);if(!t)return;pt(e,{fromListItem:n,toList:[t,s]})}if(u){const n=(0,a.getNode)(e,s);if(!n)return;pt(e,{fromList:t,fromStartIndex:i[i.length-1]+1,toList:[n,s],deleteFromList:!1})}return ht(e,{at:[...i,0]}),!0}const[,d]=s,u=[...i,1];if(!(0,a.isLastChild)(t,i)){mt(e,l)||(0,a.insertNodes)(e,{type:o.type,children:[]},{at:u});const t=(0,a.getNode)(e,u);if(!t)return;pt(e,{fromListItem:s,toList:[t,u],fromStartIndex:i[i.length-1]+1,deleteFromList:!1})}const E=c.Path.next(d);return c.Transforms.moveNodes(e,{at:i,to:E}),!0})()})),o},gt=(e,t=!0)=>{const[...n]=(0,a.getNodes)(e,{at:e.selection,match:{type:(0,a.getPluginType)(e,nt)}});if(0===n.length)return;const o=[],r=[];for(const t of n){const n=t[1],l=c.Path.parent(n);o.some((e=>{const t=c.Path.parent(e);return c.Path.isAncestor(t,l)}))||(o.push(n),r.push(c.Editor.pathRef(e,n)))}const l=t?r:r.reverse();for(const n of l){const o=n.unref();if(!o)continue;const r=(0,a.getParent)(e,o);if(!r)continue;const l=(0,a.getParent)(e,r[1]);t?Et(e,{list:l,listItem:r}):l&&dt(e,l[1])&&ft(e,{list:l,listItem:r})}},Tt=(e,{type:t})=>{e&&e.selection&&c.Editor.withoutNormalizing(e,(()=>{const n=(0,a.someNode)(e,{match:{type:t}});if(n){const t=1;for(;t;){const[...t]=(0,a.getNodes)(e,{at:e.selection,match:{type:(0,a.getPluginType)(e,nt)}});if(!t||0===t.length||t[0].length<2||t[0][1].length<=3)break;gt(e,!1)}const n=yt(e,{});if(!n)return;ft(e,{list:n.list,listItem:n.listItem})||ht(e)}if(!n){const n={type:t,children:[]};(0,a.wrapNodes)(e,n);const o=[...(0,a.getNodes)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_DEFAULT)}})];(0,a.setNodes)(e,{type:(0,a.getPluginType)(e,nt)});const r={type:(0,a.getPluginType)(e,tt),children:[]};for(const[,t]of o)(0,a.wrapNodes)(e,r,{at:t});if(!o||0===o.length)return;let l=o&&o.length>0&&o[0].length>1&&o[0][1];if(l&&0==l[0])return;l[0]--;let i=(0,a.getAbove)(e,{at:e.selection,match:{type:[Je,et]}});const s=(0,a.getAbove)(e,{at:l,match:{type:[Je,et]}});if(!s||s[0].type!=i[0].type)return;if(pt(e,{fromList:i,toList:s,deleteFromList:!1}),i=(0,a.getAbove)(e,{at:e.selection,match:{type:[Je,et]}}),l[0]++,l[0]++,l[0]>=e.children.length)return;const c=(0,a.getAbove)(e,{at:l,match:{type:[Je,et]}});if(!c||c[0].type!=i[0].type)return;pt(e,{fromList:c,toList:i,deleteFromList:!1})}}))},Nt=e=>t=>n=>{const o=(0,a.getPluginTypes)([Je,et])(t);if("Tab"===n.key)return n.preventDefault(),void gt(t,!n.shiftKey);const r=e?(0,a.mapPlatePluginKeysToOptions)(t,e):[];for(const{type:e,hotkey:l}of r){if(!l)continue;const r=st(l);for(const l of r)ct(l)(n)&&o.includes(e)&&Tt(t,{type:e})}},yt=(e,{at:t=e.selection}={})=>{const n=(0,a.getPluginType)(e,tt);if(t&&(0,a.someNode)(e,{at:t,match:{type:n}})){const o=(0,a.getParent)(e,t);if(!o)return;const[,r]=o;c.Range.isRange(t)&&!(0,a.isCollapsed)(t)&&1===r.length&&(t=t.focus.path);const l=(0,a.getAbove)(e,{at:t,match:{type:n}})||(0,a.getParent)(e,r);if(!l)return;const[i,s]=l;if(i.type!==n)return;const d=(0,a.getParent)(e,s);if(!d)return;return{list:d,listItem:l}}},_t=(e,{fromListItem:t,toListItem:n,start:o})=>{const[,r]=t,[,l]=n,i=(0,a.findDescendant)(e,{at:r,match:{type:ut(e)}});if(!i)return 0;const[,s]=i,d=(0,a.findDescendant)(e,{at:l,match:{type:ut(e)}});let u;if(d)if(o){const[,e]=d;u=[...e,0]}else u=c.Path.next((0,a.getLastChildPath)(d));else{const t=(0,a.getParent)(e,r);if(!t)return 0;const[n]=t,o=n.type,i=[...l,1];(0,a.insertNodes)(e,{type:o,children:[]},{at:i}),u=[...i,0]}const E=(0,a.moveChildren)(e,{at:s,to:u});return c.Transforms.delete(e,{at:s}),E},Lt=(e,t)=>{const n=yt(e,{});let o=!1;if(n){const{list:r,listItem:l}=n;(0,a.isSelectionAtBlockStart)(e)&&c.Editor.withoutNormalizing(e,(()=>!!o||(o=((e,{list:t,listItem:n})=>{const[o,r]=n;if((0,a.isExpanded)(e.selection)||!mt(e,o))return!1;const l=(0,a.getPreviousPath)(r);if(l){const t=c.Editor.node(e,l);let o=c.Path.next(r);(0,a.insertNodes)(e,{type:(0,a.getPluginType)(e,tt),children:[{type:(0,a.getPluginType)(e,nt),children:[{text:""}]}]},{at:o});const i=c.Editor.node(e,o),s=c.Editor.pathRef(e,i[1]);return _t(e,{fromListItem:n,toListItem:i}),(0,a.deleteFragment)(e,{reverse:!0}),o=s.unref(),_t(e,{fromListItem:[i[0],o],toListItem:t}),c.Transforms.removeNodes(e,{at:o}),!0}pt(e,{fromListItem:n,toList:t,toListIndex:1})})(e,{list:r,listItem:l}),!!o||((0,a.isFirstChild)(l[1])&&!dt(e,r[1])?((0,a.getResetNodeOnKeyDown)({rules:[{types:[(0,a.getPluginType)(e,tt)],defaultType:(0,a.getPluginType)(e,a.ELEMENT_DEFAULT),hotkey:"backspace",predicate:()=>(0,a.isSelectionAtBlockStart)(e),onReset:e=>ht(e)}]})(e)(a.SIMULATE_BACKSPACE),void(o=!0)):((0,a.deleteFragment)(e,{unit:t,reverse:!0}),void(o=!0))))))}return o},bt=(e,{diffListPath:t,liPath:n})=>{const o=(0,a.getAbove)(e,{at:n,match:{type:ut(e)}});if(!o)return;const[r,l]=o;if(!t||!c.Path.equals(l,t)){if(r.children.length<2){const n=(0,a.getAbove)(e,{at:l,match:{type:(0,a.getPluginType)(e,tt)}});if(n)return bt(e,{liPath:n[1],diffListPath:t})||l}return n}},Mt=(e,{children:t})=>{const n=[];for(const o of t)c.Editor.isBlock(e,o[0])?n.push(...Mt(e,{children:(0,a.getChildren)(o)})):n.push(o);return n},vt=((0,a.createPluginFactory)({key:"list",plugins:[{key:Je,isElement:!0,handlers:{onKeyDown:Nt},withOverrides:({validLiChildrenTypes:e}={})=>t=>{const{insertBreak:n,deleteBackward:o,deleteFragment:r}=t;return t.insertBreak=()=>{(e=>{if(!e.selection)return;const t=yt(e,{});let n;if(t){const{list:o,listItem:r}=t;if((0,a.isBlockAboveEmpty)(e)&&(n=ft(e,{list:o,listItem:r}),n))return!0}if((0,a.getResetNodeOnKeyDown)({rules:[{types:[(0,a.getPluginType)(e,tt)],defaultType:(0,a.getPluginType)(e,a.ELEMENT_DEFAULT),predicate:()=>!n&&(0,a.isBlockAboveEmpty)(e),onReset:e=>ht(e)}]})(e)(a.SIMULATE_BACKSPACE))return!0;if(!n){const t=(e=>{const t=(0,a.getPluginType)(e,tt),n=(0,a.getPluginType)(e,nt);if(e&&e.selection){const o=(0,a.getAbove)(e,{match:{type:n}});if(!o)return;const[,r]=o,l=(0,a.getParent)(e,r);if(!l)return;const[i,s]=l;if(i.type!==t)return;c.Range.isCollapsed(e.selection)||c.Transforms.delete(e);const d=c.Editor.isStart(e,e.selection.focus,r),u=(0,a.isBlockTextEmptyAfterSelection)(e),E=c.Path.next(r),m=c.Path.next(s);if(d)return(0,a.insertNodes)(e,{type:t,children:[{type:n,children:[{text:""}]}]},{at:s}),!0;if(u){const o=c.Editor.marks(e)||{};(0,a.insertNodes)(e,{type:t,children:[{type:n,children:[(0,x.Z)({text:""},o)]}]},{at:m}),c.Transforms.select(e,m)}else c.Editor.withoutNormalizing(e,(()=>{c.Transforms.splitNodes(e),(0,a.wrapNodes)(e,{type:t,children:[]},{at:E}),c.Transforms.moveNodes(e,{at:E,to:m}),c.Transforms.select(e,m),c.Transforms.collapse(e,{edge:"start"})}));return i.children.length>1&&c.Transforms.moveNodes(e,{at:E,to:[...m,1]}),!0}})(e);if(t)return!0}})(t)||n()},t.deleteBackward=e=>{Lt(t,e)||o(e)},t.deleteFragment=()=>{(e=>{let t=!1;return c.Editor.withoutNormalizing(e,(()=>{if(!(e=>{const{selection:t}=e;return!(!t||(0,a.isCollapsed)(t))&&!!(0,a.isRangeAcrossBlocks)(e)&&(0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,tt)}})})(e))return;const n=c.Editor.end(e,e.selection),o=(0,a.getAbove)(e,{at:n,match:{type:(0,a.getPluginType)(e,tt)}}),r=o&&!mt(e,o[0])?c.Editor.pathRef(e,o[1]):void 0;(0,a.deleteFragment)(e);const l=c.Editor.start(e,e.selection),i=(0,a.getAbove)(e,{at:l,match:{type:(0,a.getPluginType)(e,tt)}});if(i&&i.length>0&&i[0].type==tt&&i[0].children&&i[0].children[0].children&&""===i[0].children[0].children[0].text&&Lt(e,"character"),r){const n=r.unref(),o=i&&(0,a.getParent)(e,i[1]),l=bt(e,{liPath:n,diffListPath:null==o?void 0:o[1]});l&&c.Transforms.removeNodes(e,{at:l}),t=!0}})),t})(t)||r()},t.normalizeNode=((e,{validLiChildrenTypes:t})=>{const{normalizeNode:n}=e,o=(0,a.getPluginType)(e,tt),r=(0,a.getPluginType)(e,nt),l=(0,a.getPluginType)(e,a.ELEMENT_DEFAULT);return([i,s])=>{if((0,a.isElement)(i)){if((0,a.match)(i,{type:ut(e)})&&(0===i.children.length||!i.children.some((e=>e.type===o))))return c.Transforms.removeNodes(e,{at:s});if(i.type!==(0,a.getPluginType)(e,tt)||!((e,{listItem:t,validLiChildrenTypes:n=[]})=>{let o=!1;const r=new Set([(0,a.getPluginType)(e,Je),(0,a.getPluginType)(e,et),(0,a.getPluginType)(e,nt),...n]),[,l]=t,i=(0,a.getChildren)(t),s=i.filter((([e])=>!r.has(e.type))).map((([,t])=>c.Editor.pathRef(e,t))),d=i[0],[u,E]=null!=d?d:[];if(!d||!c.Editor.isBlock(e,u))return(0,a.insertEmptyElement)(e,(0,a.getPluginType)(e,nt),{at:[...l,0]}),!0;c.Editor.isBlock(e,u)&&!(0,a.match)(u,{type:(0,a.getPluginType)(e,nt)})&&((0,a.setNodes)(e,{type:(0,a.getPluginType)(e,nt)}),o=!0);const m=(0,a.getChildren)(d);if(m.length>0&&c.Editor.withoutNormalizing(e,(()=>{var t;const n=[],r=[];for(const t of m){if(!c.Editor.isBlock(e,t[0]))break;n.push(c.Editor.pathRef(e,t[1])),r.push(...Mt(e,{children:(0,a.getChildren)(t)}))}const l=c.Path.next(null===(t=m[m.length-1])||void 0===t?void 0:t[1]);for(const[,t]of r.reverse())c.Transforms.moveNodes(e,{at:t,to:l});for(const t of n){const n=t.unref();n&&c.Transforms.removeNodes(e,{at:n})}n.length>0&&(o=!0)})),o)return!0;for(const t of s.reverse()){const n=t.unref();n&&c.Transforms.moveNodes(e,{at:n,to:[...E,0]})}return s.length>0})(e,{listItem:[i,s],validLiChildrenTypes:t})){var d;if(i.type===r&&r!==l&&(null===(d=(0,a.getParent)(e,s))||void 0===d?void 0:d[0].type)!==o)return void(0,a.setNodes)(e,{type:l},{at:s});n([i,s])}}}})(t,{validLiChildrenTypes:e}),t},deserializeHtml:{validNodeName:"UL"}},{key:et,isElement:!0,handlers:{onKeyDown:Nt},deserializeHtml:{validNodeName:"OL"}},{key:tt,isElement:!0,deserializeHtml:{validNodeName:"LI"},then:(e,{type:t})=>({inject:{pluginsByKey:{[a.KEY_DESERIALIZE_HTML]:{editor:{insertData:{preInsert:()=>(0,a.someNode)(e,{match:{type:t}})}}}}}})},{key:nt,isElement:!0}]}),(e,t)=>{var n;const o=e&&(null==(n=e.selection)?void 0:n.anchor.path[0])&&e.children[e.selection.anchor.path[0]];if(!o)return!0;const r=o.type||a.ELEMENT_DEFAULT,l=K[r];return l&&l[t]}),At=(e,t)=>{if(e&&e.selection){if(vt(e,t))return;(0,a.setNodes)(e,{type:t},{match:t=>c.Editor.isBlock(e,t)})}},xt=(e,t)=>{((e,t)=>{if(e.selection){const n=(0,a.getParent)(e,e.selection);if(!n)return;const[o]=n;!(0,a.isElement)(o)||(0,a.isType)(e,o,a.ELEMENT_CODE_BLOCK)||(0,a.isType)(e,o,a.ELEMENT_CODE_LINE)||t()}})(e,(()=>Tt(e,{type:t})))},It={options:{rules:[{hotkey:"shift+enter"},{hotkey:"enter",query:{allow:[a.ELEMENT_CODE_BLOCK,a.ELEMENT_BLOCKQUOTE,a.ELEMENT_TD,a.ELEMENT_TH]}}]}},Ct={types:[a.ELEMENT_BLOCKQUOTE],defaultType:a.ELEMENT_PARAGRAPH},kt={options:{rules:[(0,x.Z)({},Ct,{hotkey:"Enter",predicate:a.isBlockAboveEmpty}),(0,x.Z)({},Ct,{hotkey:"Backspace",predicate:a.isSelectionAtBlockStart})]}},Dt={options:{rules:[{hotkey:"mod+enter"},{hotkey:"mod+shift+enter",before:!0},{hotkey:"enter",query:{start:!0,end:!0,allow:a.KEYS_HEADING}}]}},Rt={options:{rules:[{mode:"block",type:a.ELEMENT_H1,match:"# ",format:e=>At(e,a.ELEMENT_H1)},{mode:"block",type:a.ELEMENT_H2,match:"## ",format:e=>At(e,a.ELEMENT_H2)},{mode:"block",type:a.ELEMENT_H3,match:"### ",format:e=>At(e,a.ELEMENT_H3)},{mode:"block",type:a.ELEMENT_H4,match:"#### ",format:e=>At(e,a.ELEMENT_H4)},{mode:"block",type:a.ELEMENT_H5,match:"##### ",format:e=>At(e,a.ELEMENT_H5)},{mode:"block",type:a.ELEMENT_H6,match:"###### ",format:e=>At(e,a.ELEMENT_H6)},{mode:"block",type:a.ELEMENT_BLOCKQUOTE,match:"> ",format:e=>At(e,a.ELEMENT_BLOCKQUOTE)},{mode:"block",type:a.ELEMENT_BLOCKQUOTE,match:"> >",format:e=>At(e,a.ELEMENT_BLOCKQUOTE)},{mode:"block",type:a.ELEMENT_HR,match:"---",format:e=>{if(e&&e.selection){if(vt(e,a.ELEMENT_HR))return;const t=c.Editor.node(e,e.selection),[n]=t;n&&0===n.text.trim().length?((0,a.setNodes)(e,{type:a.ELEMENT_HR}),(0,a.insertNodes)(e,{type:a.ELEMENT_DEFAULT,children:[{text:""}]})):((0,a.insertNodes)(e,{type:a.ELEMENT_DEFAULT,children:[{text:""}]}),(0,a.setNodes)(e,{type:a.ELEMENT_HR}),c.Transforms.move(e,{distance:1,unit:"line"}))}}},{mode:"block",type:a.ELEMENT_CODE_BLOCK,match:"```",triggerAtBlockStart:!1,format:e=>{vt(e,a.ELEMENT_UL)||G(e,{defaultType:(0,a.getPluginType)(e,a.ELEMENT_DEFAULT),insertNodesOptions:{select:!0}})}},{mode:"block",type:a.ELEMENT_LI,match:["* ","- "],format:e=>{vt(e,a.ELEMENT_UL)||xt(e,a.ELEMENT_UL)}},{mode:"block",type:a.ELEMENT_LI,match:["1. ","1) "],format:e=>{vt(e,a.ELEMENT_UL)||xt(e,a.ELEMENT_OL)}},{mode:"block",type:a.ELEMENT_TABLE,match:"||",format:e=>{if(e&&e.selection){if(vt(e,a.ELEMENT_TABLE))return;fe(e)}}},{mode:"mark",type:[a.MARK_BOLD,a.MARK_ITALIC],match:"**_"},{mode:"mark",type:[a.MARK_BOLD,a.MARK_ITALIC],match:"_**"},{mode:"mark",type:[a.MARK_ITALIC],match:"___"},{mode:"mark",type:[a.MARK_BOLD],match:"__**"},{mode:"mark",type:[a.MARK_BOLD,a.MARK_ITALIC],match:"____**"},{mode:"mark",type:a.MARK_BOLD,match:"**"},{mode:"mark",type:a.MARK_ITALIC,match:"_"},{mode:"mark",type:a.MARK_STRIKETHROUGH,match:"~~"},{mode:"mark",type:a.MARK_CODE,match:"`"}]}},wt=[(0,a.createResetNodePlugin)(kt),(0,a.createSoftBreakPlugin)(It),(0,a.createExitBreakPlugin)(Dt),(0,a.createAutoformatPlugin)(Rt),(0,a.createTrailingBlockPlugin)({type:a.ELEMENT_PARAGRAPH})],Pt="article",Bt=(0,a.createPluginFactory)({key:Pt,deserializeHtml:{validNodeNames:["ARTICLE"]}}),St="abbr",jt=(0,a.createPluginFactory)({key:St,deserializeHtml:{validNodeName:"ABBR"}}),Ot="address",Ht=(0,a.createPluginFactory)({key:Ot,deserializeHtml:{validNodeName:"ADDRESS"}}),Ut="aside",Kt=(0,a.createPluginFactory)({key:Ut,deserializeHtml:{validNodeName:"ASIDE"}}),Zt="section",Ft=(0,a.createPluginFactory)({key:Zt,deserializeHtml:{validNodeName:"SECTION"}}),$t="comment",Gt=(0,a.createPluginFactory)({key:$t,deserializeHtml:{validNodeName:"COMMENT"}}),zt=[(0,a.createParagraphPlugin)(),(0,a.createBlockquotePlugin)(),(0,a.createHeadingPlugin)(),(0,a.createBoldPlugin)(),(0,a.createItalicPlugin)(),(0,a.createUnderlinePlugin)(),(0,a.createStrikethroughPlugin)(),(0,a.createCodePlugin)(),Bt(),jt(),Ht(),Kt(),Ft(),Bt(),Gt()],Vt=(0,a.createPluginFactory)({key:a.ELEMENT_MEDIA_EMBED,isElement:!0,isVoid:!0,then:(e,{type:t=a.ELEMENT_MEDIA_EMBED})=>({deserializeHtml:{validNodeName:"VIDEO",rules:[{validNodeName:"VIDEO"}],getNode:e=>{const n=e.getAttribute("src");return n?{type:t,url:n}:{}}}})}),qt=[(0,a.createLinkPlugin)(),(0,a.createListPlugin)(),(0,a.createImagePlugin)(),(0,a.createTablePlugin)(),$(),(0,a.createHorizontalRulePlugin)(),(0,a.createSelectOnBackspacePlugin)({options:{query:{allow:[a.ELEMENT_IMAGE,a.ELEMENT_HR,a.ELEMENT_MEDIA_EMBED]}}}),Vt()],Wt=[(0,a.createAlignPlugin)(),Vt(),(0,a.createHighlightPlugin)(),(0,a.createFontSizePlugin)(),(0,a.createFontColorPlugin)(),(0,a.createFontBackgroundColorPlugin)()],Yt=[(0,a.createAlignPlugin)()],Qt={[Qe.WYSIWYG]:{plugins:[...zt,...qt,...wt],components:[],toolbar:[]},[Qe.PAGES]:{plugins:[...zt,...qt,...wt,...Wt],components:[],toolbar:[]},[Qe.KNOWLEDGEBASE]:{plugins:[...zt,...qt,...wt,...Yt],components:[],toolbar:[]},[Qe.DISCUSSIONS]:{plugins:[...zt,...qt,...wt],components:[],toolbar:[]}},Xt=e=>{const t=w((0,o.useCallback)((e=>e.setBalloonState),[]));return(0,o.useCallback)((n=>o=>{if(!o||!n||!n.selection)return;let r=null,l=null;const i=K[e.current],s=c.Editor.marks(n);if(o.shiftKey||13!=o.keyCode){if(o.altKey&&o.shiftKey)switch(o.keyCode){case 48:r=a.ELEMENT_DEFAULT;break;case 49:r=a.ELEMENT_H1;break;case 50:r=a.ELEMENT_H2;break;case 51:r=a.ELEMENT_H3;break;case 52:r=a.ELEMENT_H4;break;case 53:r=a.ELEMENT_H5;break;case 54:r=a.ELEMENT_H6;break;case 75:return o.preventDefault(),o.stopPropagation(),void((!s||s&&!s[a.MARK_CODE])&&t(A.LINK.ADD));case 77:l=a.MARK_CODE;break;case 88:l=a.MARK_STRIKETHROUGH;break;case 84:if(o.preventDefault(),o.stopPropagation(),i&&i[a.ELEMENT_TABLE])return;return void fe(n,{header:!1});default:return}else if(o.metaKey&&(66==o.keyCode||73==o.keyCode))return o.preventDefault(),o.stopPropagation(),l=66==o.keyCode?a.MARK_BOLD:a.MARK_ITALIC,void(i&&!i[l]&&s[a.MARK_CODE]||(0,a.toggleMark)(n,{key:l}))}else a.KEYS_HEADING.includes(null==e?void 0:e.current),s&&s[a.MARK_BOLD]&&(0,a.toggleMark)(n,{key:a.MARK_BOLD}),s&&s[a.MARK_ITALIC]&&(0,a.toggleMark)(n,{key:a.MARK_ITALIC}),s&&s[a.MARK_STRIKETHROUGH]&&(0,a.toggleMark)(n,{key:a.MARK_STRIKETHROUGH}),s&&s[a.MARK_CODE]&&(0,a.toggleMark)(n,{key:a.MARK_CODE});if(8==o.keyCode)try{if((e=>{const t=(0,a.getAbove)(e,{match:{type:[a.ELEMENT_CODE_LINE,a.ELEMENT_DEFAULT]}}),n=(0,a.getAbove)(e,{match:{type:[a.ELEMENT_CODE_BLOCK]}});return n&&n[1]&&t&&0===t[1][1]})(n))return o.preventDefault(),n.deleteBackward()}catch(e){}l&&(o.preventDefault(),o.stopPropagation(),i&&i[l]||(0,a.toggleMark)(n,{key:l})),r&&(o.preventDefault(),o.stopPropagation(),i&&i[r]||(0,a.toggleNodeType)(n,{activeType:r}))}),[])},Jt=e=>(0,o.useCallback)((t=>n=>{if(!n||!t||!t.selection)return;let o=null,r=null;const l=K[e.current],i=c.Editor.marks(t);if(n.shiftKey||13!=n.keyCode){if(n.altKey&&n.shiftKey)switch(n.keyCode){case 48:o=a.ELEMENT_DEFAULT;break;case 88:r=a.MARK_STRIKETHROUGH;break;default:return}else if(n.metaKey&&(66==n.keyCode||73==n.keyCode))return n.preventDefault(),n.stopPropagation(),r=66==n.keyCode?a.MARK_BOLD:a.MARK_ITALIC,void((!l||l[r]||i[a.MARK_CODE])&&(0,a.toggleMark)(t,{key:r}))}else a.KEYS_HEADING.includes(e.current)&&n.stopPropagation(),i&&i[a.MARK_BOLD]&&(0,a.toggleMark)(t,{key:a.MARK_BOLD}),i&&i[a.MARK_ITALIC]&&(0,a.toggleMark)(t,{key:a.MARK_ITALIC}),i&&i[a.MARK_STRIKETHROUGH]&&(0,a.toggleMark)(t,{key:a.MARK_STRIKETHROUGH});r&&(n.preventDefault(),n.stopPropagation(),l&&l[r]||(0,a.toggleMark)(t,{key:r})),o&&(n.preventDefault(),n.stopPropagation(),l&&l[o]||(0,a.toggleNodeType)(t,{activeType:o}))}),[]);var en=n(14922),tn=n.n(en),nn=n(62188);const on=e=>{if(/<!entity/gi.test(e))return!1;const t=(new DOMParser).parseFromString(e,"application/xml").querySelector("svg");return!((e=>e.querySelectorAll("script").length>0)(t)||t&&((e,t=200)=>{const n=e.querySelectorAll("use");let o=0;for(let i=0;i<n.length&&o<t;i++){var r;const s=n[i];let a=null!=(r=s.getAttribute("xlink:href"))?r:s.getAttribute("href");a=a?a.replace("#",""):"",s.setAttribute("href","#"+a);const c=e.getElementById(a),d=(null==c?void 0:c.querySelectorAll("use"))||[];o+=d.length;for(let n=0;n<d.length&&o<t;n++){var l;const t=(null==(l=d[n].getAttribute("href"))?void 0:l.replace("#",""))||"",r=e.getElementById(t);o+=((null==r?void 0:r.querySelectorAll("use"))||[]).length}}return o>=t})(t))},rn=e=>"svg+xml"===(null==e?void 0:e.split("/")[1]);var ln=n(45860),sn=n(26663),an=n.n(sn);const cn=async({signal:e,model:t,modelId:n,name:o,type:r,size:l})=>{const i={model:t,modelId:n,name:o,type:r,size:l};return await ln.postmanGateway.post({url:`${an().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:"/files/initiate",method:"post",service:"documenter",data:{body:i},signal:e})},dn=async({signal:e,model:t,modelId:n,name:o,type:r,size:l,path:i,fileId:s})=>{const a={model:t,modelId:n,name:o,type:r,size:l,path:i,fileId:s};return await ln.postmanGateway.post({url:`${an().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:"/files",method:"post",service:"documenter",data:{body:a},signal:e})},un=e=>{try{let t={};if(e.children.length>0)for(let n=0;n<e.children.length;n++){const o=e.children.item(n),r=o.nodeName;if(void 0===t[r])t[r]=un(o);else{if(void 0===t[r].push){const e=t[r];t[r]=[],t[r].push(e)}t[r].push(un(o))}}else t=e.textContent;return t}catch(e){}},En=async({presignedURLData:e,file:t})=>{const{fields:n,uploadUrl:o}=e;return new Promise(((e,r)=>{const l=an().IMAGE_UPLOAD_URL;if(!l)return r("Couldn't upload. Try again.");const i=new FormData;if("object"==typeof n)for(const[e,t]of Object.entries(n))i.append(e,t);i.append("file",t),fetch(o,{method:"POST",body:i}).then((e=>{if(e&&e.ok)return e.text();r("Couldn't upload. Try again.")})).then((t=>{var n;const o=(new window.DOMParser).parseFromString(t,"text/xml"),i=un(o);if(null!=i&&null!=(n=i.PostResponse)&&n.Key){const t=`${l}/${i.PostResponse.Key}`;e(t)}else r("Couldn't upload. Try again.")})).catch((e=>{r(e)}))}))},mn=async({signal:e,entityModel:t})=>await ln.postmanGateway.post({url:`${an().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:`/files/usage?model=${t}`,method:"get",service:"documenter",signal:e}),pn=new Set(["png","jpeg","jpg","gif","svg+xml"]),hn=e=>!g.INVALID_FILE_NAME_REGEX.test(e),fn=e=>{let t={isValidSourceUrl:!1};try{e=/^(https?:\/\/)[\S\s]*$/.test(e)?e:"https://"+e;const n=new URL(e),o=v.SUPPORTED_SOURCES_ATTRIBUTES;let r;for(const e of v.SUPPORTED_SOURCES)n.host.toLowerCase().includes(`${e}`)&&(r=e);switch(r){case o.YOUTUBE.source:if(o.YOUTUBE.EmbedUrlRegex.test(e)){t={isValidSourceUrl:!0,embedUrl:e};break}if(o.YOUTUBE.normalUrlRegex.test(e)){t={isValidSourceUrl:!0,embedUrl:`${o.YOUTUBE.embedUrlPrefix}${n.searchParams.get("v")}`};break}t={isValidSourceUrl:!1};break;case o.VIMEO.source:if(o.VIMEO.EmbedUrlRegex.test(e)){t={isValidSourceUrl:!0,embedUrl:e};break}if(o.VIMEO.normalUrlRegex.test(e)){t={isValidSourceUrl:!0,embedUrl:`${o.VIMEO.embedUrlPrefix}${n.pathname.split("/")[1]}`};break}t={isValidSourceUrl:!1};break;default:t={isValidSourceUrl:!1}}return t}catch(e){return t}},gn=e=>e.length<=g.MAX_ALLOWED_FILE_NAME_LENGTH,Tn=e=>{const[t,n]=e.split("/");return!(!t||!n)&&g.ALLOWED_FILE_FORMATS.includes(t)&&g.ALLOWED_FILE_TYPES.includes(n)},Nn=e=>{const t=new FileReader;return t.readAsDataURL(e),new Promise(((e,n)=>{t.onloadend=function(){const o=new Image;o.src=t.result,o.addEventListener("load",(function(){e({data:t.result,width:`${this.width}`,height:`${this.height}`})})),t.onerror=function(e){n(`Error: ${e}`)}}}))},yn=e=>(0,nn.Am)({status:"error",description:null!=e?e:"Couldn't upload. Try again."}),_n=async(e,t,n,o,r)=>{const{name:l,size:i,type:s}=e,a={name:l,type:s,size:i};if(i>g.MAX_FILE_SIZE)yn(y);else{if(!l||!s||!i)return void yn(T);if(!gn(l))return void yn(_);if(!hn(l))return void yn(L);if(!Tn(s))return void yn(N);if(rn(s)){const l=new FileReader;let i=null;return l.addEventListener("load",(function(l){i=l.target.result,on(i)?Ln(e,t,n,o,r,a):yn(M)})),void l.readAsText(e)}Ln(e,t,n,o,r,a)}},Ln=async(e,t,n,o,r,l)=>{try{const{operation:c}=await mn({entityModel:t.model});if(c){const{allowed:d,limit:u}=c;if(d)try{const i=await cn((0,x.Z)({},l,t));if(null!=i&&i.fields){const c=await(0,s.nanoid)(6),{data:d,width:u,height:E}=await Nn(e);((e,t,n,o,r)=>{try{const l={text:""},i={id:n,width:o,height:r,type:(0,a.getPluginType)(e,a.ELEMENT_IMAGE),url:t,children:[l]};(0,a.insertNodes)(e,i)}catch(e){yn()}})(o,d,c,u,E),r(!0),await bn(i,e,l,t,n,o,c),r(!1)}}catch(e){yn()}else{var i;const e=null!=(i=u/1048576)?i:"-";yn(`Couldn't upload. Your ${e} MB storage is full. To increase storage, contact support.`)}}}catch(e){yn()}finally{r(!1)}},bn=async(e,t,n,o,r,l,i)=>{let s,d=null;try{if(d=await En({presignedURLData:e,file:t}),s=[...c.Editor.nodes(l,{match:e=>e.id&&e.id===i,at:[]})],!s)throw new Error("No Image Node Found");const[,r]=s[0];(0,a.setNodes)(l,{url:d},{at:r});try{var u;const t=(0,x.Z)({},n,{fileId:null==e?void 0:e.fileId,path:null==e||null==(u=e.fields)?void 0:u.key});dn((0,x.Z)({},t,o))}catch(e){}}catch(e){const[,t]=s&&s[0];t&&c.Transforms.removeNodes(l,{at:t}),yn()}};function Mn(e){if(e)for(let r=0;r<e.length;r++){if("a"==e[r].type&&0==r&&e.unshift({text:""}),"a"==e[r].type&&r==e.length-1)e.push({text:""});else if(e[r]&&"li"==e[r].type&&e[r].children){const t={type:"p",children:[]};for(let n=0;n<e[r].children.length;n++)(e[r].children[n].text||"a"==e[r].children[n].type)&&t.children.push(e[r].children[n]);for(let t=0;t<e[r].children.length;t++)(e[r].children[t].text||"a"==e[r].children[t].type)&&(e[r].children.splice(t,1),t--);t.children&&t.children.length>0&&(e[r].children=[t].concat(e[r].children))}else if("code_block"===e[r].type){var t;const n=e[r].children,o=(null==n?void 0:n.length)&&n[n.length-1];"code_line"===(null==o?void 0:o.type)&&""===(null==o||null==(t=o.children[0])||null==(t=t.text)?void 0:t.trim())&&e[r].children.pop()}else if("blockquote"===e[r].type){var n;const t=e[r].children;var o;"p"===(null==(n=t[0])?void 0:n.type)&&(e[r].children=null==(o=t[0])?void 0:o.children)}else e[r]&&"p"==e[r].type&&e[r].children&&1==e[r].children.length&&e[r].children[0].text&&e[r].children[0].text.split("\n").length>1&&""===e[r].children[0].text.trim()&&(e.splice(r,1),r--);e[r]&&Mn(e[r].children)}}function vn(e){return Mn(e),e}const An=["h1","h2","h3","h4","h5","h6","blockquote","pre","a","ul","ol","nl","li","b","img","strong","em","strike","code","hr","div","table","thead","caption","tbody","tr","th","td","p","i","abbr","address","section","article","aside","dd","dl","dt","tfoot","s","del","comment","u","video"];function xn(e){if(e){e=e.replaceAll("<b>","<strong>").replaceAll("</b>","</strong>").replaceAll("\x3c!--","<comment>").replaceAll("--\x3e","</comment>").replaceAll("<br>","&#013;");for(const t of An)e=(e=e.replaceAll(`<${t}>`,`<${t} class='preserveHtml'>`)).replaceAll(`<${t} `,`<${t} class='preserveHtml' `)}return e}const In=["type","children"];function Cn(e=""){return m()(e,{allowedTags:["b","i","u","ol","ul","li","a","strong","em","strike","s","p","del"],allowedAttributes:{a:["href"]}})}var kn=n(92672),Dn=n(48090),Rn=n.n(Dn),wn=n(59392);const Pn="%20",Bn="_SPACE_REPLACEMENT_STRING_",Sn="_SPACE_REVERTING_STRING_",jn=new RegExp(Pn,"g"),On=new RegExp(Bn,"g"),Hn=new RegExp(Sn,"g"),Un=e=>/<\/?[a-z][\S\s]*>/i.test(e)||/(?=<!--)([\S\s]*?)-->/i.test(e),Kn=e=>t=>{const n=(0,a.htmlTextNodeToString)(t);if(n)return n;if(!(0,a.isHtmlElement)(t))return null;const o=(0,a.htmlBrToNewLine)(t);if(o)return o;const r=Fn(e,t);if(r)return r;const l=((e,t)=>{const n=(0,a.pipeDeserializeHtmlElement)(e,t);if(n){var o;let l;const{node:i,withoutChildren:s}=n;let c=null!==(l=i.children)&&void 0!==l?l:Zn(e,t);if(t.classList.contains("preserveHtml")&&(i.preserveHtml=!0,t.getAttribute("width")&&(i.width=t.getAttribute("width")),t.getAttribute("height")&&(i.height=t.getAttribute("height")),t.getAttribute("alt")&&(i.alt=t.getAttribute("alt"))),"VIDEO"==t.tagName){var r;const e=null==(r=t.attributes.src)?void 0:r.value,n=tn()(e)||0===e.indexOf("#"),o=n&&fn(e).isValidSourceUrl;n?o||(i.type=a.ELEMENT_LINK,i.url=e,i.convertToVideo=!0,c=[{text:e}]):n||(i.type="p",i.convertToVideo=!0,c=[{text:e}])}if("PRE"==t.tagName){const e=t.firstElementChild;e&&"CODE"==e.tagName&&e.classList.length>0&&e.classList[0].includes("language-")&&(i.lang=e.classList[0].slice(9))}return"IMG"===t.tagName&&"A"===(null==(o=t.parentElement)?void 0:o.tagName)&&(i.isImageAsLink=!0),"IMG"!==t.tagName||i.preserveHtml||(i.preserveHtml=!0,t.getAttribute("alt")&&(i.alt=t.getAttribute("alt"))),(0===c.length||s)&&(c=[{text:""}]),(0,kn.jsx)("element",i,c)}})(e,t);return l||(0,a.htmlElementToLeaf)(e,t)},Zn=(e,t)=>[...t.childNodes].flatMap(Kn(e)),Fn=(e,t)=>"BODY"===t.nodeName?(0,kn.jsx)("fragment",{},Zn(e,t)):null,$n=(e,{element:t,stripWhitespace:n=!1})=>{"string"==typeof t&&(t=(0,a.htmlStringToDOMNode)(t,n));const o=((e,t)=>Kn(e)(t))(e,t);return(0,a.normalizeDescendantsToDocumentFragment)(e,{descendants:o})},Gn=(e,t)=>{const n=e.split(/(class="[^"]*")/g);let o="";for(const[e,t]of n.entries())e%2!=0||(o+=t);return o},zn=(e,{nodes:t,slateProps:n,stripDataAttributes:o=!0,preserveClassNames:r,stripWhitespace:l=!0})=>{let i=t.map((t=>{if(c.Text.isText(t)){if(t.text&&tn()(t.text)){const e=t.text.replace(jn,Bn);t=(0,x.Z)({},t,{text:e})}return((e,{props:t,slateProps:n,preserveClassNames:o})=>{const{children:r}=t;return e.plugins.reduce(((o,l)=>{let i,s;if(!l.isLeaf)return o;t=(0,x.Z)({},(0,a.pipeInjectProps)(e,t),{children:encodeURIComponent(o)});const c=null!==(i=null===(s=l.serializeHtml)||void 0===s?void 0:s.call(l,t))&&void 0!==i?i:(0,a.pluginRenderLeaf)(e,l)(t);if(c===r)return o;let d=decodeURIComponent(Rn().renderToStaticMarkup((0,a.createElementWithSlate)((0,x.Z)({},n,{children:c}))));return d=Gn(d),d}),r)})(e,{props:{leaf:t,text:t,children:(0,a.isEncoded)(t.text)?t.text:encodeURIComponent(t.text),attributes:{"data-slate-leaf":!0},editor:e},slateProps:n,preserveClassNames:r})}if(t.type===a.ELEMENT_LINK&&t.url&&tn()(t.url,{allow_fragments:!0})){let e=encodeURIComponent(t.url);e=e.replace(jn,Bn),t=(0,x.Z)({},t,{url:e})}if(t.type===a.ELEMENT_IMAGE&&t.alt){const e=t.alt.replace(jn,Sn);t=(0,x.Z)({},t,{alt:e})}const o=((e,{props:t,slateProps:n,preserveClassNames:o})=>{let r=`<div>${t.children}</div>`;if(!t.element.type)return r;if(t.element.preserveHtml)switch(t.element.type){case"p":return t.element.convertToVideo?`<custom><video src=${t.element.url} ${t.element.alt?`alt="${t.element.alt}"`:""} ${t.element.width?`width=${t.element.width}`:""} ${t.element.height?`height=${t.element.height}`:""} /></custom>`:`<custom><p>${t.children}</p></custom>`;case"blockquote":return`<custom><blockquote>${t.children}</blockquote></custom>`;case"a":return t.element.convertToVideo?`<custom><video src=${t.element.url} ${t.element.alt?`alt="${t.element.alt}"`:""} ${t.element.width?`width=${t.element.width}`:""} ${t.element.height?`height=${t.element.height}`:""} /></custom>`:`<custom><a href=${t.element.url}>${t.children}</a></custom>`;case"h1":return`<custom><h1>${t.children}</h1></custom>`;case"h2":return`<custom><h2>${t.children}</h2></custom>`;case"h3":return`<custom><h3>${t.children}</h3></custom>`;case"h4":return`<custom><h4>${t.children}</h4></custom>`;case"h5":return`<custom><h5>${t.children}</h5></custom>`;case"ul":return`<custom><ul>${t.children}</ul></custom>`;case"li":return`<custom><li>${t.children}</li></custom>`;case"table":return`<custom><table>${t.children}</table></custom>`;case"td":return`<custom><td>${t.children}</td></custom>`;case"tr":return`<custom><tr>${t.children}</tr></custom>`;case"th":return`<custom><th>${t.children}</th></custom>`;case"ol":return`<custom><ol>${t.children}</ol></custom>`;case"img":return`<custom><img src=${t.element.url} ${t.element.alt?`alt="${t.element.alt}"`:""} ${t.element.width?`width=${t.element.width}`:""} ${t.element.height?`height=${t.element.height}`:""} /></custom>`;case"abbr":return`<custom><abbr>${t.children}</abbr></custom>`;case"address":return`<custom><address>${t.children}</address></custom>`;case"section":return`<custom><section>${t.children}</section></custom>`;case"article":return`<custom><article>${t.children}</article></custom>`;case"aside":return`<custom><aside>${t.children}</aside></custom>`;case"comment":return`<custom><comment>${t.children}</comment></custom>`}if("media_embed"===t.element.type)return`<custom><video src=${t.element.url} ${t.element.alt?`alt="${t.element.alt}"`:""} ${t.element.width?`width=${t.element.width}`:""} ${t.element.height?`height=${t.element.height}`:""} /></custom>`;var l;if("code_block"===t.element.type)return`<pre class=${null!=(l=t.element.lang)?l:"plain"}><code>${t.children}</code></pre>`;if("code_line"===t.element.type){if(t.children&&t.children.trim()){const e=decodeURIComponent(t.children);return Un(e)?`<div>${(0,wn.encode)(e)}\n</div>`:`<div>${t.children}\n</div>`}return""}if("blockquote"===t.element.type){if(t.children&&t.children.trim()){const e=decodeURIComponent(t.children);return!Un(p(e,{inline:!0}))&&Un(e)?`<blockquote>${(0,wn.encode)(e)}</blockquote>\n`:`<blockquote>${t.children}</blockquote>\n`}return""}return t=(0,a.pipeInjectProps)(e,t),e.plugins.some((o=>{let l,i;if(!o.isElement||null===o.serializeHtml||t.element.type!==o.type)return!1;const s=(0,a.createElementWithSlate)((0,x.Z)({},n,{children:null!==(l=null===(i=o.serializeHtml)||void 0===i?void 0:i.call(o,t))&&void 0!==l?l:(0,a.pluginRenderElement)(e,o)(t)}));return r=Rn().renderToStaticMarkup(s),r=Gn(r),!0})),r})(e,{props:{element:t,children:encodeURIComponent(zn(e,{nodes:t.children,preserveClassNames:r,stripWhitespace:l})),attributes:{"data-slate-node":"element",ref:null},editor:e},slateProps:n,preserveClassNames:r});return o})).join("");try{return i=i.replace(/( style)="[^"]+"/gm,""),i=i.replace(/( id)="[^"]+"/gm,""),(0,a.isEncoded)(i)&&(i=decodeURIComponent(i).replace(On,Pn)),i.includes(Sn)&&(i=i.replace(Hn,Pn)),o&&(i=(0,a.stripSlateDataAttributes)(i)),i}catch(e){}};let Vn;const qn=e=>(0,a.isElement)(e)&&(e.type===a.ELEMENT_TD||e.type===a.ELEMENT_TH),Wn=(e,t,n)=>{for(const[o,r]of e.children.entries())r.children[0].type!=a.ELEMENT_UL&&r.children[0].type!=a.ELEMENT_OL||Wn(r.children[0],t,n),r.children[0].type==a.ELEMENT_DEFAULT&&((0!==o||""!==t.text.trim())&&Qn(n),r.children[0].type="li",c.Transforms.insertNodes(n,r.children[0])),r.children.length>1&&c.Transforms.insertNodes(n,r.children[1])},Yn=e=>!e||!e.children||1===e.children.length&&Yn(e.children[0]),Qn=e=>{Vn=c.Path.next(Vn),(0,a.insertNodes)(e,{type:"li",children:[{type:"p",children:[{text:""}]}]},{at:Vn}),c.Transforms.select(e,Vn)},Xn=(e,t,n,o)=>{if(t.length>0){if(!e||!e.selection)return;const r=e.children[e.selection.anchor.path[0]],l=r&&r.type,i=c.Editor.node(e,e.selection),[s]=i;if(n===a.ELEMENT_TABLE)t=((e,t,n)=>{const[o]=c.Editor.nodes(t,{match:qn});if(e.length>1)return[{type:o[0]&&o[0].type,children:[{text:n}]}];if(e[0].type===a.ELEMENT_TABLE){const t=e[0].children;if(t.length>1)return[{type:o[0]&&o[0].type,children:[{text:n}]}];const r=t[0].children,l=[];for(const e of r)for(const t of e.children)l.push(t);return[{type:o[0]&&o[0].type,children:l}]}return[{type:o[0]&&o[0].type,children:e[0].type===a.ELEMENT_DEFAULT?[...e[0].children]:[{text:n}]}]})(t,e,o),c.Transforms.insertFragment(e,t);else if(n===a.ELEMENT_CODE_BLOCK||n===a.ELEMENT_BLOCKQUOTE)c.Transforms.insertFragment(e,[{text:o}]);else if(t.length>0&&(t[0].type===a.ELEMENT_OL||t[0].type===a.ELEMENT_UL)){if(Yn(t[0])&&s&&s.text&&""!==s.text.trim())return void c.Transforms.insertFragment(e,t);l!==a.ELEMENT_OL&&l!==a.ELEMENT_UL&&c.Transforms.insertNodes(e,{type:t[0].type,children:[{type:"li",children:[{type:"p",children:[{text:""}]}]}]}),Vn=e.selection.anchor.path.slice(0,-2),Wn(t[0],s,e)}else if(t=(e=>{if(e.length>1)return e;if(e[0].type===a.ELEMENT_TABLE){const t=e[0].children;if(t.length>=2)return e;const n=t[0].children,o=[];for(const e of n)for(const t of e.children)o.push(t);return[{type:a.ELEMENT_DEFAULT,children:o}]}return e})(t),s&&s.text&&""!==s.text.trim())c.Transforms.insertFragment(e,t);else{const n=e.selection;c.Transforms.insertNodes(e,t),c.Transforms.removeNodes(e,{at:n,match:e=>"p"==e.type&&1==e.children.length&&""===e.children[0].text})}}},Jn=async(e,t,n,o,r)=>{if(tn()(o))try{if(await(async e=>new Promise((t=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onloadend=function(){if(n.status.toString().startsWith("2")){var e;const o=n.getAllResponseHeaders().match(/^content-type:\s*(.*?)$/im);pn.has(null==o||null==(e=o[1])?void 0:e.split("/")[1])?t(!0):t(!1)}else t(!1)},n.send()})))(o))return void(0,a.insertImage)(e,o)}catch(e){}const l=xn(o),i=r?function(e,t){if("string"!=typeof e)return"";const n=(0,x.Z)({gfm:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1},{gfm:!0});return u().setOptions(n),Cn(u()(e))}(l):h(l,{gfm:!0}),s=$n(e,{plugins:Qt[t].plugins,element:i});return Xn(e,vn(s),n.current,o)},eo=(e,t,n,r,l,i)=>{const s=w((0,o.useCallback)((e=>e.setIsMediaUploading),[]));return(0,o.useCallback)((o=>async c=>{c.preventDefault(),c.stopPropagation();const d=c.clipboardData||window.clipboardData;if(l){const t=d.files[0],l=K[e.current];if(t)return void(l&&!l[a.ELEMENT_IMAGE]&&_n(t,n,r,o,s))}const u=d.getData("text/html"),E=d.getData("text/plain"),m=d.getData("application/x-slate-fragment");return m?((e,t,n,o,r,l)=>{const i=o&&decodeURIComponent(window.atob(o)),s=i&&JSON.parse(i);if(s){if(Array.isArray(s)){const t=l?function(e){const t=new Set(["b","i","u","ol","ul","li","a","strong","em","strike","s","p","del"]),n=[];for(const o of e){const{type:e,children:r}=o,l=(0,Z.Z)(o,In);if(e&&t.has(e))n.push(o);else{const e=(0,x.Z)({type:"p",children:r},l);n.push(e)}}return n}(s):s;return Xn(e,t,n.current,r)}return Jn(e,t,n,r,l)}})(o,t,e,m,E,i):u?((e,t,n,o,r,l)=>{const i={isAPIAuthEditor:l};o=l?Cn(o):p(o,i);const{body:s}=(new DOMParser).parseFromString(o,"text/html"),a=$n(e,{plugins:Qt[t].plugins,element:s});return Xn(e,a,n.current,r)})(o,t,e,u,E,i):E?Jn(o,t,e,E,i):void 0}),[])},to=(e,t,n,r)=>{if(!r)return;const l=w((e=>e.setIsMediaUploading));return(0,o.useCallback)((o=>async r=>{r.preventDefault(),r.stopPropagation();try{const i=r.dataTransfer.files[0],s=K[e.current];return i&&s&&!s[a.ELEMENT_IMAGE]&&_n(i,t,n,o,l),!1}catch(e){return!1}}),[])},no=e=>{if(e)return(0,o.useCallback)((()=>async e=>{e.preventDefault(),e.stopPropagation();const t=document.querySelector(".collection-sidebar-drag-layer");t&&(t.style.transform="unset");const n=document.querySelector(".collection-sidebar-drag-preview");n&&(n.style.display="none")}),[])},oo=()=>()=>async e=>{var t;null==(t=e.target)||t.dispatchEvent(new DragEvent("dragleave"))};function ro(e){e.addRule("highlightedCodeBlock",{filter:function(e){const t=e.firstChild;return"PRE"===e.nodeName&&t&&"CODE"===t.nodeName},replacement:function(e,t,n){var o;const r=t.className||"";return"\n\n"+n.fence+("plain"==r?"":" "+r)+"\n"+(null==t||null==(o=t.firstChild)||null==(o=o.textContent)?void 0:o.replaceAll("*",Mo))+"\n "+n.fence+"\n\n"}})}function lo(e){e.addRule("strikethrough",{filter:["del","s","strike"],replacement:function(e){return"~~"+e+"~~"}})}function io(e){e.addRule("blockquote",{filter:["blockquote"],replacement:function(e){return/<\/?[a-z][\S\s]*>/i.test(t=e)||/(?=<!--)([\S\s]*?)-->/i.test(t)?`> ${(0,wn.encode)(e)} \n`:`> ${e} \n`;var t}})}const so=Array.prototype.indexOf,ao=Array.prototype.every,co={};function uo(e){const t=e.parentNode;return"THEAD"===t.nodeName||t.firstChild===e&&("TABLE"===t.nodeName||function(e){const t=e.previousSibling;return"TBODY"===e.nodeName&&(!t||"THEAD"===t.nodeName&&/^\s*$/i.test(t.textContent))}(t))&&ao.call(e.childNodes,(function(e){return"TH"===e.nodeName}))}function Eo(e,t){let n=" ";return 0===so.call(t.parentNode.childNodes,t)&&(n="| "),n+e.replaceAll("\n","<br>")+" |"}function mo(e){e.keep((function(e){return"TABLE"===e.nodeName&&uo(e.rows[0])}));for(const t in co)e.addRule(t,co[t])}function po(e){e.addRule("taskListItems",{filter:function(e){return"checkbox"===e.type&&"LI"===e.parentNode.nodeName},replacement:function(e,t){return(t.checked?"[x]":"[ ]")+" "}})}function ho(e){e.addRule("figure",{filter:["figure"],replacement:function(e,t){var n,o;return(null==(n=t.querySelector("img"))?void 0:n.outerHTML)||(null==(o=t.querySelector("video"))?void 0:o.outerHTML)||""}})}function fo(e){e.addRule("a",{filter:["a"],replacement:function(e,t){return`[${null==t?void 0:t.innerHTML}](${null==t?void 0:t.getAttribute("href")})`}})}function go(e){e.addRule("BoldInCode",{filter:function(e){return"CODE"===e.tagName&&e.childNodes.length>0&&"STRONG"===e.childNodes[0].tagName},replacement:function(e){return"**`"+e.slice(2,-2)+"`**"}})}function To(e){e.addRule("AsteriskInCode",{filter:function(e){return"CODE"===e.tagName&&e.childNodes.length>0&&"SPAN"===e.childNodes[0].tagName},replacement:function(e){return e.replaceAll("*",Mo)}})}function No(e){e.addRule("Paragraph in list",{filter:function(e){return"P"===e.tagName&&"LI"===e.parentNode.tagName},replacement:function(e,t){return t.parentNode.parentNode&&t.parentNode.parentNode.parentNode&&"X-TURNDOWN"==t.parentNode.parentNode.parentNode.tagName&&!t.parentNode.nextSibling?e+"\n":e}})}function yo(e){e.addRule("hr",{filter:["hr"],replacement:function(){return"---"}})}co.tableCell={filter:["th","td"],replacement:function(e,t){return Eo(e=e.trim(),t)}},co.tableRow={filter:"tr",replacement:function(e,t){let n="";const o={left:":--",right:"--:",center:":-:"};if(uo(t))for(let e=0;e<t.childNodes.length;e++){let r="---";const l=(t.childNodes[e].getAttribute("align")||"").toLowerCase();l&&(r=o[l]||r),n+=Eo(r,t.childNodes[e])}return"\n"+e+(n?"\n"+n:"")}},co.table={filter:function(e){return"TABLE"===e.nodeName&&uo(e.rows[0])},replacement:function(e){return"\n\n"+(e=e.replace("\n\n","\n"))+"\n\n"}},co.tableSection={filter:["thead","tbody","tfoot"],replacement:function(e){return e}};const _o=function(){function e(e,t){return Array.from({length:t+1}).join(e)}const t=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL","CUSTOM"];function n(e){return i(e,t)}const o=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function r(e){return i(e,o)}const l=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function i(e,t){return t.includes(e.nodeName)}function s(e,t){return e.getElementsByTagName&&t.some((function(t){return e.getElementsByTagName(t).length}))}const a={};function c(e){return e?e.replace(/(\n+\s*)+/g,"\n"):""}function d(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(const t in e.rules)this.array.push(e.rules[t])}function u(e,t,n){for(const o of e)if(E(o,t,n))return o}function E(e,t,n){const o=e.filter;if("string"==typeof o){if(o===t.nodeName.toLowerCase())return!0}else if(Array.isArray(o)){if(o.includes(t.nodeName.toLowerCase()))return!0}else{if("function"!=typeof o)throw new TypeError("`filter` needs to be a string, array, or function");if(o.call(e,t,n))return!0}}function m(e){const t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function p(e,t,n){return e&&e.parentNode===t||n(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}a.paragraph={filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},a.lineBreak={filter:"br",replacement:function(e,t,n){return n.br+"\n"}},a.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(t,n,o){const r=Number(n.nodeName.charAt(1));return"setext"===o.headingStyle&&r<3?"\n\n"+t+"\n"+e(1===r?"=":"-",t.length)+"\n\n":"\n\n"+e("#",r)+" "+t+"\n\n"}},a.blockquote={filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n"}},a.list={filter:["ul","ol"],replacement:function(e,t){const n=t.parentNode;return"LI"===n.nodeName&&n.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n"}},a.listItem={filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");let o=n.bulletListMarker+" ";const r=t.parentNode;if("OL"===r.nodeName){const e=r.getAttribute("start"),n=Array.prototype.indexOf.call(r.children,t);o=(e?Number(e)+n:n+1)+". "}return o+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}},a.indentedCodeBlock={filter:function(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},a.fencedCodeBlock={filter:function(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(t,n,o){const r=((n.firstChild.getAttribute("class")||"").match(/language-(\S+)/)||[null,""])[1],l=n.firstChild.textContent,i=o.fence.charAt(0);let s=3;const a=new RegExp("^"+i+"{3,}","gm");let c;for(;c=a.exec(l);)c[0].length>=s&&(s=c[0].length+1);const d=e(i,s);return"\n\n"+d+r+"\n"+l.replace(/\n$/,"")+"\n"+d+"\n\n"}},a.horizontalRule={filter:"hr",replacement:function(e,t,n){return"\n\n"+n.hr+"\n\n"}},a.inlineLink={filter:function(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t){const n=t.getAttribute("href");let o=c(t.getAttribute("title"));return o&&(o=' "'+o+'"'),"["+e+"]("+n+o+")"}},a.referenceLink={filter:function(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,n){const o=t.getAttribute("href");let r,l,i=c(t.getAttribute("title"));switch(i&&(i=' "'+i+'"'),n.linkReferenceStyle){case"collapsed":r="["+e+"][]",l="["+e+"]: "+o+i;break;case"shortcut":r="["+e+"]",l="["+e+"]: "+o+i;break;default:var s=this.references.length+1;r="["+e+"]["+s+"]",l="["+s+"]: "+o+i}return this.references.push(l),r},references:[],append:function(){let e="";return this.references.length>0&&(e="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),e}},a.emphasis={filter:["em","i"],replacement:function(e,t,n){return e.trim()?n.emDelimiter+e+n.emDelimiter:""}},a.strong={filter:["strong","b"],replacement:function(e,t,n){return e.trim()?n.strongDelimiter+e+n.strongDelimiter:""}},a.code={filter:function(e){const t=e.previousSibling||e.nextSibling,n="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!n},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");const t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"";let n="`";const o=e.match(/`+/gm)||[];for(;o.includes(n);)n+="`";return n+t+e+t+n}},a.image={filter:"img",replacement:function(e,t){const n=c(t.getAttribute("alt")),o=t.getAttribute("src")||"",r=c(t.getAttribute("title"));return o?"!["+n+"]("+o+(r?' "'+r+'"':"")+")":""}},d.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;let t;return(t=u(this.array,e,this.options))||(t=u(this._keep,e,this.options))||(t=u(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(let t=0;t<this.array.length;t++)e(this.array[t],t)}};const h="undefined"==typeof window?{}:window,f=function(){const e=h.DOMParser;let t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(e){}return t}()?h.DOMParser:function(){const e=function(){};return function(){let e=!1;try{document.implementation.createHTMLDocument("").open()}catch(t){window.ActiveXObject&&(e=!0)}return e}()?e.prototype.parseFromString=function(e){const t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:e.prototype.parseFromString=function(e){const t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},e}();function g(e,t){let o;return o="string"==typeof e?(T=T||new f,T).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):e.cloneNode(!0),function(e){const t=e.element,n=e.isBlock,o=e.isVoid,r=e.isPre||function(e){return"PRE"===e.nodeName};if(!t.firstChild||r(t))return;let l=null,i=!1,s=null,a=p(s,t,r);for(;a!==t;){if(3===a.nodeType||4===a.nodeType){let e=a.data.replace(/[\t\n\r ]+/g," ");if(l&&!l.data.endsWith(" ")||i||" "!==e[0]||(e=e.slice(1)),!e){a=m(a);continue}a.data=e,l=a}else{if(1!==a.nodeType){a=m(a);continue}n(a)||"BR"===a.nodeName?(l&&(l.data=l.data.replace(/ $/,"")),l=null,i=!1):o(a)||r(a)?(l=null,i=!0):l&&(i=!1)}const e=p(s,a,r);s=a,a=e}l&&(l.data=l.data.replace(/ $/,""),l.data||m(l))}({element:o,isBlock:n,isVoid:r,isPre:t.preformattedCode?N:null}),o}let T;function N(e){return"PRE"===e.nodeName||"CODE"===e.nodeName}function y(e,t){return e.isBlock=n(e),e.isCode="CODE"===e.nodeName||e.parentNode.isCode,e.isBlank=function(e){return!r(e)&&!function(e){return i(e,l)}(e)&&/^\s*$/i.test(e.textContent)&&!function(e){return s(e,o)}(e)&&!function(e){return s(e,l)}(e)}(e),e.flankingWhitespace=function(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};const n=function(e){const t=e.match(/^(([\t\n\r ]*)(\s*))[\S\s]*?((\s*?)([\t\n\r ]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}(e.textContent);return n.leadingAscii&&_("left",e,t)&&(n.leading=n.leadingNonAscii),n.trailingAscii&&_("right",e,t)&&(n.trailing=n.trailingNonAscii),{leading:n.leading,trailing:n.trailing}}(e,t),e}function _(e,t,o){let r,l,i;return"left"===e?(r=t.previousSibling,l=/ $/):(r=t.nextSibling,l=/^ /),r&&(3===r.nodeType?i=l.test(r.nodeValue):o.preformattedCode&&"CODE"===r.nodeName?i=!1:1!==r.nodeType||n(r)||(i=l.test(r.textContent))),i}const L=Array.prototype.reduce,b=[[/\\/g,"\\\\"],[/~/g,"\\~"],[/~~/g,"\\~~"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/]/g,"\\]"],[/^>/g,"\\>"],[/^(\d+)\. /g,"$1\\. "]];function M(e){if(!(this instanceof M))return new M(e);const t={rules:a,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,t){return t.isBlock?"\n\n":""},keepReplacement:function(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML},defaultReplacement:function(e,t){return t.isBlock?"\n\n"+e+"\n\n":e}};this.options=function(e){for(let t=1;t<arguments.length;t++){const n=arguments[t];for(const t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}return e}({},t,e),this.rules=new d(this.options)}function v(e){const t=this;return L.call(e.childNodes,(function(e,n){let o="";return 3===(n=new y(n,t.options)).nodeType?o=n.isCode?n.nodeValue:t.escape(n.nodeValue):1===n.nodeType&&(o=x.call(t,n)),I(e,o)}),"")}function A(e){const t=this;return this.rules.forEach((function(n){"function"==typeof n.append&&(e=I(e,n.append(t.options)))})),e.replace(/^[\t\n\r]+/,"").replace(/\s+$/,"")}function x(e){const t=this.rules.forNode(e);let n=v.call(this,e);const o=e.flankingWhitespace;return(o.leading||o.trailing)&&(n=n.trim()),o.leading+t.replacement(n,e,this.options)+o.trailing}function I(e,t){const n=function(e){let t=e.length;for(;t>0&&"\n"===e[t-1];)t--;return e.slice(0,Math.max(0,t))}(e),o=t.replace(/^\n*/,""),r=Math.max(e.length-n.length,t.length-o.length);return n+"\n\n".slice(0,Math.max(0,r))+o}return M.prototype={turndown:function(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType))}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";const t=v.call(this,new g(e,this.options));return A.call(this,t)},use:function(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this)}return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return b.reduce((function(e,t){return e.replace(t[0],t[1])}),e)}},M}(),Lo=new _o({headingStyle:"atx",codeBlockStyle:"fenced",emDelimiter:"_",bulletListMarker:"-"}).use([function(e){e.use([ro,lo,mo,po,ho,No,go,yo,To,io,fo])}]).keep(["custom","u"]),bo="_PARA_REPLACEMENT_STRING_",Mo="_ASTERISK_REPLACEMENT_STRING_",vo=(e="")=>{var t,n;const o=null==e||null==(t=e.replaceAll("\n","\n<br>"))?void 0:t.replaceAll("&para",bo);let r=null!=(n=Lo.turndown(o))?n:"";return r=r.replaceAll("*****","*").replaceAll("<custom>","").replaceAll("</custom>","").replaceAll("<strong>","<b>").replaceAll("</strong>","</b>").replaceAll("<em>","<i>").replaceAll("</em>","</i>").replaceAll("<comment>","\x3c!-- ").replaceAll("</comment>"," --\x3e").replaceAll("*","\\*").replaceAll("\\*\\*","**").replaceAll(Mo,"*").replaceAll(bo,"&para"),r},Ao=(e,t)=>{let n;const o=(new DOMParser).parseFromString(t,"text/html");return n=$n(e,{element:o.body}),n.push(me()),n[0]&&!n[0].children&&(n=[me()]),n},xo=({attributes:e,children:t,nodeProps:n})=>(0,S.jsx)("div",(0,x.Z)({className:"slate-table-wrapper"},e,{children:(0,S.jsx)("table",(0,x.Z)({},n,{children:(0,S.jsx)("tbody",{children:t})}))}));var Io=n(58560),Co=n(80605),ko=n(15761),Do=n(45631),Ro=n(71132),wo=n(27162),Po=n(5246),Bo=n(10530),So=n(9460),jo=n(65862),Oo=n(94250),Ho=n(43088),Uo=n(49627);const Ko=({text:e,onLinkClick:t})=>(0,S.jsxs)(So.ZP,{children:[e," To increase storage, ",(0,S.jsx)("a",{target:"_blank",onClick:e=>{e.preventDefault(),t&&t()},href:"https://go.pstmn.io/support-request",rel:"noreferrer",children:(0,S.jsx)(So.ZP,{type:"link-subtle",isExternal:!0,children:"contact support."})})]}),Zo="file-usage--warning",Fo=(0,o.memo)((({usage:e,limit:t,usagePercentage:n,onLinkClick:r})=>{const[l,s]=(0,o.useState)(null),[a,c]=(0,o.useState)(""),d=(0,o.useRef)(null),u=(0,o.useCallback)((()=>{r&&r()}),[r]),E=(0,o.useMemo)((()=>(e/1048576).toFixed(2)),[e]),m=(0,o.useMemo)((()=>t/1048576),[t]),p=(0,o.useMemo)((()=>(0,S.jsx)(Ko,{text:`${E} MB of ${m} MB used.`,onLinkClick:u})),[m,E]),h=(0,o.useMemo)((()=>(0,S.jsx)(Ko,{text:`${E} MB of ${m} MB used.`,onLinkClick:u})),[m,E]),f=(0,o.useMemo)((()=>(0,S.jsx)(Ko,{text:`Your ${m} MB storage is full.`,onLinkClick:u})),[m]);return(0,o.useEffect)((()=>{n>=100?(s(f),c("file-usage--error")):n>=99?(s(h),c(Zo)):n>=90&&(s(p),c(Zo)),requestAnimationFrame((()=>{d.current&&(d.current.style.width=`${n}%`)}))}),[n]),(0,S.jsxs)(Io.Z,{direction:"column",className:"usage-container",children:[(0,S.jsxs)("div",{className:"file-usage-bars",children:[(0,S.jsx)("div",{className:"file-limit"}),(0,S.jsx)("div",{ref:d,className:i()("file-usage",a),title:`${n}%`})]}),l&&(0,S.jsx)("p",{className:"file-usage-text",children:l})]})})),$o=(e,t,n,o,r)=>{try{var l;const d=F.ReactEditor.toDOMPoint(t,null==o?void 0:o.anchor)[0].parentElement,u=null==d?void 0:d.getBoundingClientRect(),E=e.getBoundingClientRect(),m=null==(l=document.querySelector(`#mimir-${n}`))?void 0:l.getBoundingClientRect(),{left:p,top:h}=u,{width:f,height:g}=E,{left:T,top:N,width:y,height:_}=m;let L=h-N,b=p-T;switch(r){case A.IMAGE.EDIT:{var i;const e=null==d||null==(i=d.closest(".image-element"))?void 0:i.querySelector("img"),{left:t,top:n,width:o,height:r}=(null==e?void 0:e.getBoundingClientRect())||{};L=n+r-N-g-8,b=t-T+o/2-f/2;break}case A.MEDIA.EDIT:{var s,a,c;const e="none"===getComputedStyle(null==d||null==(s=d.closest(".media-element"))?void 0:s.querySelector(".media-resize")).display?null==d||null==(a=d.closest(".media-element"))?void 0:a.querySelector(".media-loader"):null==d||null==(c=d.closest(".media-element"))?void 0:c.querySelector("iframe"),{left:t,top:n,width:o,height:r}=(null==e?void 0:e.getBoundingClientRect())||{};L=n+r-N-g-8,b=t-T+o/2-f/2;break}default:L+g+16>_&&(L=L-(L+g-_)-40),b+f+16>y&&(b=b-(b+f-y)-8)}e.style.top=`${Math.max(L,50)}px`,e.style.left=`${Math.max(b,0)}px`}catch(e){}};function Go({editorId:e,isOffline:t,source:n,modelDetails:r}){const l=(0,o.useRef)(null),s=(0,a.usePlateEditorState)(e),d=w((0,o.useCallback)((e=>e.balloonState),[])),u=w((0,o.useCallback)((e=>e.setBalloonState),[])),E=w((0,o.useCallback)((e=>e.setIsMediaUploading),[])),m=w((0,o.useCallback)((e=>e.editorSelection),[])),[p,h]=(0,o.useState)(""),[v,I]=(0,o.useState)(0),[C,k]=(0,o.useState)(null),[D,R]=(0,o.useState)(null),[P,B]=(0,o.useState)(null),[j,O]=(0,o.useState)(!1);(0,o.useEffect)((()=>{d===A.IMAGE.ADD&&0===v&&G()}),[]),(0,o.useEffect)((()=>{1===v&&(R(null),setTimeout((()=>{const e=document.querySelector(".image-url-input input");e&&e.focus()}),100))}),[v]),(0,o.useEffect)((()=>{let t=s&&s.selection;if(!t){if(!m)return;t=m}if(d===A.IMAGE.EDIT||d===A.IMAGE.ADD){if(d===A.IMAGE.EDIT){const e=(0,a.getAbove)(s,{match:{type:a.ELEMENT_IMAGE}});e&&h(e[0].url)}$o(l.current,s,e,t,d)}}),[d,s&&s.selection]),(0,o.useEffect)((()=>{null!==C&&E(C)}),[C]);const H=(0,o.useCallback)((()=>{h(""),k(!1),u(A.CLOSE),F.ReactEditor.focus(s)}),[s]),U=(0,o.useCallback)((()=>{if(s&&m&&tn()(p))try{c.Transforms.select(s,m),(0,a.insertImage)(s,p),c.Transforms.insertNodes(s,[me()]),H()}catch(e){}}),[s,m,p,H]),K=(0,o.useCallback)((()=>{if(s&&m)try{c.Transforms.select(s,m),c.Transforms.delete(s,{unit:"block"}),H()}catch(e){}}),[s,m,H]),Z=(0,o.useCallback)((()=>{if(!(p.length<=0))try{c.Transforms.select(s,m),(0,a.getAbove)(s,{match:{type:a.ELEMENT_IMAGE}})&&c.Transforms.setNodes(s,{url:p}),H()}catch(e){}}),[s,m,p,H]),$=(0,o.useCallback)((e=>{if(e&&13===e.keyCode){if(e.preventDefault(),!tn()(p))return;d===A.IMAGE.UPDATE?Z():U()}}),[p]),G=(0,o.useCallback)((async()=>{if(!t){O(!0);try{const{operation:e}=await mn({entityModel:r.model});if(e){const{allowed:t,limit:n,usage:o}=e;B({allowed:t,limit:n,usage:o})}}catch(e){}finally{O(!1)}}}),[]),z=(0,o.useCallback)((async(t,n)=>{let o=null;try{const i=`mimir-file-uploader-${e}`,d=document.getElementById(i),u=null==d?void 0:d.files[0];k(!0),o=await En({presignedURLData:t,file:u}),u&&(u.value=null),tn()(o)&&(0,a.insertImage)(s,o),c.Transforms.deselect(s),H();try{var l;const e=(0,x.Z)({},n,{fileId:null==t?void 0:t.fileId,path:null==t||null==(l=t.fields)?void 0:l.key});dn((0,x.Z)({},e,r))}catch(e){}}catch(e){Y(e)}finally{k(!1)}}),[]),V=(0,o.useCallback)((async e=>{try{const t=await cn((0,x.Z)({},e,r));null!=t&&t.fields&&z(t,e)}catch(e){Y(e)}}),[]),q=(0,o.useCallback)((e=>{const{name:t,size:n,type:o}=e;if(R(null),n>g.MAX_FILE_SIZE)R(y);else if(P&&n>P.remaining)R((0,S.jsx)(Ko,{text:b}));else{if(!t||!o||!n)return void R(T);if(!gn(t))return void R(_);if(!hn(t))return void R(L);if(!Tn(o))return void R(N);if(rn(o)){const r=new FileReader;let l=null;return r.addEventListener("load",(function(e){var r;l=null==(r=e.target)?void 0:r.result,on(l)?V({name:t,type:o,size:n}):R(M)})),void r.readAsText(e)}V({name:t,type:o,size:n})}}),[]),W=(0,o.useCallback)((e=>{const t=e[0];q(t)}),[]),Y=(0,o.useCallback)((t=>{R(t);const n=`mimir-file-uploader-${e}`,o=document.getElementById(n),r=null==o?void 0:o.files[0];r&&(r.value=null)}),[]),Q=(0,o.useMemo)((()=>{if(P){const{limit:e,usage:t}=P;if(!Number.isNaN(e)&&!Number.isNaN(t)){return Number.parseFloat((t/e*100).toFixed(2))}}return null}),[P]);return(0,S.jsxs)(Io.Z,{ref:l,direction:"column",className:i()("image-balloon-container",{small:n===f,auto:d===A.IMAGE.EDIT}),children:[d===A.IMAGE.EDIT?(0,S.jsx)(S.Fragment,{children:!p.startsWith("data:")&&(0,S.jsx)(Io.Z,{gap:"spacing-s",alignItems:"center",children:(0,S.jsx)(Co.Z,{onClick:K,type:"tertiary",icon:(0,S.jsx)(Ho.Z,{}),tooltip:"Delete image","data-testid":"delete-image-balloon-btn"})})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(ko.Z,{activeTabIndex:v,onChange:I,type:"primary",className:"image-balloon-tabs",children:[(0,S.jsxs)(Do.Z,{children:[(0,S.jsx)(Ro.Z,{label:"Upload",isDisabled:t||C||d===A.IMAGE.UPDATE}),(0,S.jsx)(Ro.Z,{label:"Embed URL",isDisabled:t||C})]}),(0,S.jsxs)(wo.Z,{children:[(0,S.jsx)(Po.Z,{children:(0,S.jsxs)(Io.Z,{direction:n===f?"column":"row",gap:"spacing-s",alignItems:n===f?"flex-start":"center",children:[j||C||t?(0,S.jsx)(Co.Z,{type:"primary",minWidth:"68px",className:"image-balloon-loader",text:"Browse",isLoading:C||j,isDisabled:t}):(0,S.jsx)(Bo.Z,{id:`mimir-file-uploader-${e}`,actionLabel:"Browse",accept:".png,.jpeg,.jpg,.gif,.svg",onChange:W,isDisabled:C||!!P&&!P.allowed}),C?(0,S.jsx)(So.ZP,{type:"para",color:"content-color-secondary",children:"Uploading..."}):(0,S.jsxs)(Io.Z,{direction:"column",children:[(0,S.jsx)(So.ZP,{type:"para",color:"content-color-secondary",children:"PNG, JPG, SVG, and GIFs are supported."}),(0,S.jsx)(So.ZP,{type:"para",color:"content-color-secondary",children:"Maximum 5MB."})]})]})}),(0,S.jsx)(Po.Z,{children:(0,S.jsxs)(Io.Z,{gap:"spacing-s",alignItems:"center",children:[(0,S.jsx)(jo.Z,{placeholder:"Image URL",value:p,onKeyDown:e=>$(e),onChange:e=>h(e.target.value),size:"medium",className:"image-url-input",isDisabled:C}),(0,S.jsx)(Co.Z,{type:"primary",isDisabled:C||!tn()(p),size:"medium",text:d===A.IMAGE.UPDATE?"Edit":"Embed",onClick:d===A.IMAGE.UPDATE?Z:U})]})})]})]}),(0,S.jsx)(Co.Z,{onClick:H,type:"tertiary",className:"image-close-btn",isDisabled:C,icon:(0,S.jsx)(Uo.Z,{})})]}),0===v&&D&&(0,S.jsx)(Oo.Z,{onDismiss:()=>R(null),className:"image-balloon-banner",status:"error",children:"string"==typeof D?D:"Couldn't upload. Try again."}),d!==A.IMAGE.EDIT&&0===v&&!C&&Q&&Q>=g.MIN_USAGE_PERCENTAGE_WARNING&&(0,S.jsx)(Fo,{usage:null==P?void 0:P.usage,limit:null==P?void 0:P.limit,usagePercentage:Q})]})}const zo=({editorId:e,isOffline:t,source:n})=>{const r=(0,o.useRef)(null),l=(0,a.usePlateEditorState)(e),s=w((0,o.useCallback)((e=>e.balloonState),[])),d=w((0,o.useCallback)((e=>e.setBalloonState),[])),u=w((0,o.useCallback)((e=>e.editorSelection),[])),[E,m]=(0,o.useState)("");(0,o.useEffect)((()=>{setTimeout((()=>{const e=document.querySelector(".image-url-input input");null==e||e.focus()}),100)}),[]),(0,o.useEffect)((()=>{let t=l&&l.selection;if(!t){if(!u)return;t=u}if(s===A.IMAGE.EDIT||s===A.IMAGE.ADD){if(s===A.IMAGE.EDIT){const e=(0,a.getAbove)(l,{match:{type:a.ELEMENT_IMAGE}});e&&m(e[0].url)}$o(r.current,l,e,t,s)}}),[s,l,u]);const p=(0,o.useCallback)((()=>{m(""),d(A.CLOSE),F.ReactEditor.focus(l)}),[l]),h=(0,o.useCallback)((()=>{if(l&&u){if(E.length<=0)return;c.Transforms.select(l,u),(0,a.insertImage)(l,E),c.Transforms.insertNodes(l,[me()]),p()}}),[l,u,E,p]),g=(0,o.useCallback)((()=>{l&&u&&(c.Transforms.select(l,u),c.Transforms.delete(l,{unit:"block"}),p())}),[l,u,p]),T=(0,o.useCallback)((()=>{tn()(E)&&(c.Transforms.select(l,u),(0,a.getAbove)(l,{match:{type:a.ELEMENT_IMAGE}})&&c.Transforms.setNodes(l,{url:E}),p())}),[l,u,E,p]),N=(0,o.useCallback)((e=>{if(e&&13===e.keyCode){if(e.preventDefault(),!tn()(E))return;s===A.IMAGE.UPDATE?T():h()}}),[E]);return(0,S.jsx)(Io.Z,{ref:r,gap:"spacing-s",direction:"row",alignItems:"center",className:i()("image-balloon-container","image-balloon-container--legacy",{small:n===f,auto:s===A.IMAGE.EDIT}),children:s===A.IMAGE.EDIT?(0,S.jsx)(Co.Z,{onClick:g,type:"tertiary",icon:(0,S.jsx)(Ho.Z,{})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(jo.Z,{placeholder:"Image URL",value:E,onKeyDown:N,onChange:e=>m(e.target.value),size:"medium",className:"image-url-input"}),(0,S.jsx)(Co.Z,{type:"primary",isDisabled:t||!tn()(E),size:"medium",text:s===A.IMAGE.UPDATE?"Edit":"Embed",onClick:s===A.IMAGE.UPDATE?T:h})]})})};var Vo=n(8855),qo=n(42865);const Wo="Please enter a valid URL",Yo=function({editorId:e,source:t}){const n=(0,o.useRef)(null),r=(0,a.usePlateEditorState)(e),[l,s]=(0,o.useState)(""),[d,u]=(0,o.useState)(""),[E,m]=(0,o.useState)(""),p=w((0,o.useCallback)((e=>e.balloonState),[])),h=w((0,o.useCallback)((e=>e.setBalloonState),[])),g=w((0,o.useCallback)((e=>e.editorSelection),[]));(0,o.useEffect)((()=>{let t=r&&r.selection;if(!t){if(!g)return;{var o;const e=!!(0,a.getNode)(r,null==g||null==(o=g.anchor)?void 0:o.path),n=c.Editor.end(r,[]),l=c.Editor.range(r,n);t=e?g:l}}if(p===A.LINK.ADD)if(c.Editor.node(r,t)[0].text){var l,i;const e=Math.abs(t.anchor.offset-t.focus.offset),n=c.Editor.node(r,t)[0].text.substr(Math.min(t.focus.offset,t.anchor.offset),e);u(n),0===(null==n?void 0:n.length)?null==(l=document.querySelector(".link-text-input input"))||l.focus():null==(i=document.querySelector(".link-url-input input"))||i.focus()}else{var d;null==(d=document.querySelector(".link-text-input input"))||d.focus()}else if(p===A.LINK.EDIT){const e=(0,a.getAbove)(r,{match:{type:a.ELEMENT_LINK}});e&&(u(e[0].children[0].text),s(e[0].url))}$o(n.current,r,e,t)}),[p,r&&r.selection]);const T=(0,o.useCallback)((()=>tn()(l)||0===l.indexOf("#")),[l]),N=(0,o.useCallback)((()=>{s(""),u(""),h(A.CLOSE),F.ReactEditor.focus(r)}),[r]),y=(0,o.useCallback)((()=>{try{if(r&&g){var e;if(!T())return m("error"),void document.querySelector(".link-url-input input").focus();c.Transforms.select(r,g),c.Transforms.removeNodes(r,{match:e=>e.type===a.ELEMENT_LINK});const t=null==(e=r.selection)?void 0:e.anchor.path.slice(0,-1),n=g.anchor.path.slice(0,-2);t.length==n.length&&!t.every(((e,t)=>e==n[t]))&&c.Transforms.move(r,{options:{unit:"line"}}),c.Transforms.insertNodes(r,{type:a.ELEMENT_LINK,url:l,children:[{text:0===d.length?l:d}]}),N()}}catch(e){}}),[r,g,d,l]),_=(0,o.useCallback)((()=>{try{if(r&&g){if(!T())return m("error"),void document.querySelector(".link-url-input input").focus();c.Transforms.select(r,g),0===(0,a.getSelectionText)(r).length||(c.Transforms.select(r,g),c.Transforms.removeNodes(r,{match:e=>e.type===a.ELEMENT_LINK})),c.Transforms.insertNodes(r,{type:a.ELEMENT_LINK,url:l,children:[{text:0===d.length?l:d}]}),N()}}catch(e){}}),[r,g,d,l]),L=(0,o.useCallback)((()=>{try{r&&g&&(c.Transforms.select(r,g),c.Transforms.unwrapNodes(r,{match:e=>!c.Editor.isEditor(e)&&e.type===a.ELEMENT_LINK}),N())}catch(e){}}),[r,g]),b=(0,o.useCallback)((()=>{r&&g&&h(A.LINK.UPDATE)}),[r,g]),M=e=>{e&&13===e.keyCode&&(e.preventDefault(),p===A.LINK.UPDATE?y():_())};return(0,S.jsx)(Io.Z,{ref:n,className:i()("link-balloon-container",{small:t===f,edit:p===A.LINK.EDIT}),children:p===A.LINK.EDIT?(0,S.jsxs)(Io.Z,{gap:"spacing-xs",width:"100%",children:[(0,S.jsx)("a",{className:"link-label",href:l,target:l&&l.startsWith("#")?"_self":"_blank",rel:"noreferrer",children:(0,S.jsx)(So.ZP,{type:"link-primary",tooltip:l,isTruncated:!0,children:l})}),(0,S.jsx)(Co.Z,{type:"tertiary","data-testid":"link-edit-btn",className:i()("link-btn","link-edit-btn"),onClick:b,icon:(0,S.jsx)(Vo.Z,{}),tooltip:"Edit link"}),(0,S.jsx)(Co.Z,{type:"tertiary","data-testid":"link-unlink-btn",className:i()("link-btn","link-unlink-btn"),onClick:L,icon:(0,S.jsx)(qo.Z,{}),tooltip:"Remove link"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(Io.Z,{gap:"spacing-s",grow:1,children:[(0,S.jsxs)(Io.Z,{direction:"column",gap:"spacing-s",grow:1,children:[(0,S.jsx)(jo.Z,{"data-testid":"link-text-input",className:"link-input link-text-input",placeholder:"Text",value:d,onKeyDown:e=>M(e),onChange:e=>u(e.target.value)}),(0,S.jsx)(jo.Z,{"data-testid":"link-url-input",className:"link-input link-url-input",placeholder:"URL",value:l,validationStatus:E,validationMessage:Wo,onKeyDown:e=>M(e),onChange:e=>{m(""),s(e.target.value)}})]}),(0,S.jsx)(Io.Z,{alignSelf:"flex-end",className:i()({"has-error":E.length>0}),children:(0,S.jsx)(Co.Z,{"data-testid":"link-add-btn",className:i()("link-btn","link-add-btn"),onClick:p===A.LINK.UPDATE?y:_,type:"primary",isDisabled:!T(),tooltip:T()?null:Wo,text:p===A.LINK.UPDATE?"Edit":"Add"})})]}),(0,S.jsx)(Co.Z,{onClick:N,type:"tertiary",className:"link-close-btn",icon:(0,S.jsx)(Uo.Z,{})})]})})},Qo=function({editorId:e,_source:t}){const n=(0,o.useRef)(null),r=(0,o.useRef)(null),l=(0,o.useRef)(null),s=(0,a.usePlateEditorState)(e),[d,u]=(0,o.useState)(!1),E=w((0,o.useCallback)((e=>e.balloonState),[])),m=w((0,o.useCallback)((e=>e.setBalloonState),[])),p=w((0,o.useCallback)((e=>e.editorSelection),[])),h=(0,o.useCallback)((e=>{if(!e)return null;"TD"!==e.nodeName&&"TH"!==e.nodeName?h(e.parentElement):r.current=e}),[]);(0,o.useEffect)((()=>{if(s&&s.selection&&E===A.TABLE.EDIT)try{const t=F.ReactEditor.toDOMPoint(s,s.selection.anchor)[0];if(!t)return;h(t.parentElement);const o=r.current&&r.current.getBoundingClientRect(),l=document.querySelector(`#mimir-${e}`)&&document.querySelector(`#mimir-${e}`).getBoundingClientRect();if(u(!1),!o||!l)return void m(A.CLOSE);const{left:i,top:a}=l,{left:c,top:d,width:E}=o,p=d-a,f=c-i;n.current.style.top=`${p+2}px`,n.current.style.left=`${f-18+E}px`}catch(e){}}),[E,s&&s.selection,p]),(0,o.useEffect)((()=>{if(d){const t=s&&s.selection?s.selection:p;if(!t)return;l.current.style.opacity=1;try{const e=F.ReactEditor.toDOMPoint(s,t.anchor)[0];if(!e)return;h(e.parentElement)}catch(e){}const n=r.current&&r.current.getBoundingClientRect(),o=document.querySelector(`#mimir-${e}`)&&document.querySelector(`#mimir-${e}`).getBoundingClientRect();if(!n||!o)return void m(A.CLOSE);const{top:i,right:a,bottom:c}=o,{top:d,right:u}=n,{width:E,height:f}=l.current.getBoundingClientRect();u+E>a&&(l.current.style.right=0),u+E<=a&&(l.current.style.left=0),d+f>c&&(i+f+100<c?l.current.style.bottom="16px":l.current.style.top="16px"),d+f<=c&&(l.current.style.top="16px")}}),[d]);const f=(0,o.useCallback)((()=>{s.selection=p,(e=>{if((0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}})){const t=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TR)}});if(t){const[n,o]=t;(0,a.insertNodes)(e,he(e,{header:!1,colCount:n.children.length}),{at:c.Path.next(o),select:!0}),c.Transforms.select(e,c.Path.next(o)),c.Transforms.collapse(e,{edge:"anchor"}),F.ReactEditor.focus(e)}}})(s)}),[p]),g=(0,o.useCallback)((()=>{s.selection=p,(e=>{if((0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}})){const t=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}}),n=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TR)}});n&&t&&t[0].children.length>1&&c.Transforms.removeNodes(e,{at:n[1]}),F.ReactEditor.focus(e)}})(s)}),[p]),T=(0,o.useCallback)((()=>{s.selection=p,(e=>{if((0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}})){const t=(0,a.getAbove)(e,{match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TH),(0,a.getPluginType)(e,a.ELEMENT_TD)]}}),n=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}});if(t&&n){const o=[...c.Path.next(t[1])],r=o.length-2;for(const[t]of n[0].children.entries())o[r]=t,(0,a.insertNodes)(e,pe(e,{header:0===t}),{at:o,select:0===t})}const o=ge(e,{});if(!o)return;const{tableElement:r}=o,[l]=r;try{const t=F.ReactEditor.toDOMNode(e,l);F.ReactEditor.focus(e),setTimeout((()=>{t.scrollBy(110,0)}),100)}catch(e){}}})(s)}),[p]),N=(0,o.useCallback)((()=>{s.selection=p,(e=>{if((0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}})){const t=(0,a.getAbove)(e,{match:{type:[(0,a.getPluginType)(e,a.ELEMENT_TH),(0,a.getPluginType)(e,a.ELEMENT_TD)]}}),n=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TR)}}),o=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}});if(t&&n&&o&&n[0].children.length>1){const n=[...t[1]],r=n.length-2;for(const[t]of o[0].children.entries())n[r]=t,c.Transforms.removeNodes(e,{at:n})}F.ReactEditor.focus(e)}})(s)}),[p]),y=(0,o.useCallback)((()=>{s.selection=p,(e=>{if((0,a.someNode)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}})){const t=(0,a.getAbove)(e,{match:{type:(0,a.getPluginType)(e,a.ELEMENT_TABLE)}});t&&(c.Transforms.removeNodes(e,{at:t[1]}),e||e.selection||(0,a.insertNodes)(e,me())),F.ReactEditor.focus(e)}})(s),m(A.CLOSE)}),[p]);return(0,S.jsxs)("div",{className:"table-balloon-container",onBlur:()=>u(!1),ref:n,children:[(0,S.jsx)("span",{className:i()("table__cell__action",{"table__cell__action--active":d}),onClick:()=>{u((e=>(e&&(c.Transforms.select(s,p),F.ReactEditor.focus(s)),!e)))},children:(0,S.jsx)(Oe,{})}),d&&(0,S.jsxs)("ul",{className:i()("table__cell__dropdown",d?"table__cell__dropdown--visible":""),ref:l,children:[(0,S.jsx)("li",{className:"toolbar__cell__action toolbar__cell__action--addrow",children:(0,S.jsx)(Ne,{icon:(0,S.jsx)(Ze,{}),transform:f,editorId:e})}),"TH"===r.current.nodeName?null:(0,S.jsx)("li",{className:"toolbar__cell__action toolbar__cell__action--delrow",children:(0,S.jsx)(Ne,{icon:(0,S.jsx)(Ue,{}),transform:g,editorId:e})}),(0,S.jsx)("li",{className:"toolbar__cell__action toolbar__cell__action--addcol",children:(0,S.jsx)(Ne,{icon:(0,S.jsx)(ze,{}),transform:T,editorId:e})}),(0,S.jsx)("li",{className:"toolbar__cell__action toolbar__cell__action--delcol",children:(0,S.jsx)(Ne,{icon:(0,S.jsx)($e,{}),transform:N,editorId:e})}),(0,S.jsx)("li",{className:"toolbar__cell__action toolbar__cell__action--deltab",children:(0,S.jsx)(Ne,{icon:(0,S.jsx)(qe,{}),transform:y,editorId:e})})]})]})};var Xo=n(74962);const Jo="Please enter a valid URL",er=function({editorId:e,source:t}){const n=(0,o.useRef)(null),r=(0,a.usePlateEditorState)(e),[l,s]=(0,o.useState)(""),[d,u]=(0,o.useState)(!1),[E,m]=(0,o.useState)(!1),p=w((0,o.useCallback)((e=>e.balloonState),[])),h=w((0,o.useCallback)((e=>e.setBalloonState),[])),g=w((0,o.useCallback)((e=>e.editorSelection),[])),T=w((0,o.useCallback)((e=>e.setEditorSelection),[]));(0,o.useEffect)((()=>{setTimeout((()=>{var e;document.querySelector(".media-url-input input")&&(null==(e=document.querySelector(".media-url-input input"))||e.focus())}),100)}),[]),(0,o.useEffect)((()=>{var e;const t=tn()(l);u(t),t&&m(!(null!=(e=fn(l))&&e.isValidSourceUrl))}),[l]),(0,o.useEffect)((()=>{let t=r&&r.selection;try{if(!t){if(!g)return;{var o;const e=!!(0,a.getNode)(r,null==g||null==(o=g.anchor)?void 0:o.path),n=c.Editor.end(r,[]),l=c.Editor.range(r,n);e?t=g:(t=l,T(l))}}if(p===A.MEDIA.EDIT||p===A.MEDIA.ADD){if(p===A.MEDIA.EDIT){var l;const e=(0,a.getAbove)(r,{match:{type:a.ELEMENT_MEDIA_EMBED}});e&&s(null==(l=e[0])?void 0:l.url)}$o(n.current,r,e,t,p)}}catch(e){}}),[p,r&&r.selection]);const N=(0,o.useCallback)((async()=>{}),[t]),y=(0,o.useCallback)((()=>{s(""),h(A.CLOSE),F.ReactEditor.focus(r)}),[r]),_=(0,o.useCallback)((()=>{try{const e=fn(l);if(!e.isValidSourceUrl)return void m(!0);c.Transforms.select(r,g),(0,a.getAbove)(r,{match:{type:a.ELEMENT_MEDIA_EMBED}})&&c.Transforms.setNodes(r,{url:e.embedUrl}),y()}catch(e){}}),[r,g,l,y]),L=(0,o.useCallback)((()=>{try{if(r&&g){if(Number.parseInt(l.length)<=0)return;const e=fn(l);if(!e.isValidSourceUrl)return void m(!0);c.Transforms.select(r,g),(0,a.insertMediaEmbed)(r,{url:e.embedUrl}),c.Transforms.insertNodes(r,[me()]),y(),N(v.VIDEO_EMBED)}}catch(e){}}),[r,g,l,y]),b=(0,o.useCallback)((()=>{try{r&&g&&(c.Transforms.select(r,g),c.Transforms.delete(r,{unit:"block"}),y())}catch(e){}}),[r,g,y]),M=(0,o.useCallback)((e=>{if(e&&13===e.keyCode){if(e.preventDefault(),!tn()(l))return;p===A.MEDIA.UPDATE?_():L()}}),[l]),x=(0,o.useCallback)((()=>{try{r&&g&&(c.Transforms.select(r,g),c.Transforms.insertNodes(r,{type:a.ELEMENT_LINK,url:l,children:[{text:l}]}),y())}catch(e){}}),[r,g,l,y]);return(0,S.jsx)(Io.Z,{ref:n,gap:"spacing-s",direction:"row",alignItems:"center",className:i()("media-balloon-container",{small:t===f,auto:p===A.MEDIA.EDIT}),children:p===A.MEDIA.EDIT?(0,S.jsx)(S.Fragment,{children:!l.startsWith("data:")&&(0,S.jsx)(Io.Z,{gap:"spacing-s",alignItems:"center",children:(0,S.jsx)(Co.Z,{onClick:b,type:"tertiary",icon:(0,S.jsx)(Ho.Z,{})})})}):(0,S.jsxs)(Io.Z,{direction:"column",gap:"spacing-s",width:"100%",children:[(0,S.jsxs)(Io.Z,{direction:"row",gap:"spacing-m",alignItems:"center",justifyContent:"space-between",children:[(0,S.jsx)(Xo.Z,{type:"h3",text:"Embed URL"}),(0,S.jsx)(Co.Z,{onClick:y,type:"tertiary",icon:(0,S.jsx)(Uo.Z,{})})]}),(0,S.jsx)(So.ZP,{type:"para",color:"content-color-secondary",children:"Only Youtube and Vimeo links are supported."}),(0,S.jsxs)(Io.Z,{direction:"row",gap:"spacing-s",children:[(0,S.jsx)(jo.Z,{placeholder:"Video URL",value:l,onKeyDown:e=>M(e),onChange:e=>s(e.target.value),validationStatus:l&&!d?"error":null,validationMessage:Jo,size:"medium",className:"media-url-input",isDisabled:!1,"data-testid":"balloon-media-url-input"}),(0,S.jsx)(Co.Z,{type:"primary",isDisabled:!d||E,size:"medium",text:p===A.MEDIA.UPDATE?"Edit":"Embed",onClick:p===A.MEDIA.UPDATE?_:L,tooltip:d?E?"Unsupported media platform":null:Jo,"data-testid":"test-balloon-media-embed-button"})]}),d&&E&&(0,S.jsxs)(Oo.Z,{status:"info",hideIcon:!0,children:["Unsupported media platform. However, you can choose to ",(0,S.jsx)("a",{onClick:x,children:(0,S.jsx)(So.ZP,{type:"link-default",children:"add URL as a link."})})]})]})})};var tr=n(54073),nr=n.n(tr);const or=function({editorId:e,isOffline:t,source:n,isMediaUploadEnabled:r,modelDetails:l}){const i=(0,a.usePlateEditorState)(e),s=w((0,o.useCallback)((e=>e.balloonState),[])),d=w((0,o.useCallback)((e=>e.setBalloonState),[])),u=w((0,o.useCallback)((e=>e.nodeType),[])),E=w((0,o.useCallback)((e=>e.isMediaUploading),[]));(0,o.useEffect)((()=>()=>{d(A.CLOSE)}),[]);const m=(0,o.useMemo)((()=>nr()(d,250,{leading:!0,trailing:!1})),[]);return ve((()=>{s===A.CLOSE||E||(c.Transforms.deselect(i),d(A.CLOSE))}),[i,s]),(0,o.useEffect)((()=>{if(i&&i.selection)switch(u){case"img":return d(A.IMAGE.EDIT);case"link":return d(A.LINK.EDIT);case"table":return m(A.TABLE.EDIT);case a.ELEMENT_MEDIA_EMBED:return d(A.MEDIA.EDIT);default:return d(A.CLOSE)}}),[u,i&&i.selection]),(0,o.useMemo)((()=>{if(!i)return null;if(!s)return null;if(i.id!==e)return null;if(s.includes("IMAGE"))return r?(0,S.jsx)(Go,{editorId:e,isOffline:t,source:n,modelDetails:l}):(0,S.jsx)(zo,{editorId:e,isOffline:t,source:n});if(s.includes("LINK"))return(0,S.jsx)(Yo,{editorId:e,source:n});if(s.includes("TABLE"))return(0,S.jsx)(Qo,{editorId:e,_source:n});if(s.includes("MEDIA"))return(0,S.jsx)(er,{editorId:e,source:n});if(s===A.CLOSE)return null;throw new Error(`Unidentified balloon state - ${s}`)}),[s,i&&i.selection,t])};var rr=n(35348),lr=n(59530),ir=n.n(lr);const sr=(0,lr.keyframes)(["0%,100%{transform:translateY(-10px) translateZ(0);}50%{transform:translateY(0) translateZ(0);}"]),ar=ir().div.withConfig({displayName:"loading-indicator__LoadingWrapper",componentId:"sc-n4bb9v-0"})(["height:20px;"]),cr=ir().div.withConfig({displayName:"loading-indicator__LoadingIndicator",componentId:"sc-n4bb9v-1"})(["position:relative;display:inline-block;animation:"," 0.6s ease 0.1s infinite;background-color:var(--highlight-background-color-tertiary);border-radius:var(--border-radius-s);&,&::before,&::after{width:4px;height:20px;border-radius:var(--border-radius-s);background-color:var(--highlight-background-color-tertiary);}&::before,&::after{content:'';position:absolute;display:block;top:50%;transform:translateY(-10px) translateZ(0);}&::before{left:-6px;animation:"," 0.6s ease 0s infinite;}&::after{left:6px;animation:"," 0.6s ease 0.2s infinite;}"],sr,sr,sr),dr=e=>(0,S.jsx)(ar,{className:e.className,"data-testid":"loading-indicator",children:(0,S.jsx)(cr,{})});var ur=n(83609),Er=n(17874),mr=n.n(Er);const pr=["attributes","children","element","nodeProps","caption","resizableProps","align","draggable"],hr=(0,o.memo)((e=>{const{attributes:t,children:n,element:r,nodeProps:l,caption:s={},resizableProps:d={minWidth:100},align:u="center",draggable:E}=e,m=(0,Z.Z)(e,pr),{placeholder:p="Add a caption...",disabled:h}=s,{id:f,url:g,width:T,height:N,alt:y="",caption:_=[{children:[{text:""}]}],isImageAsLink:L}=r,b=(0,a.useEditorRef)(),M=w((0,o.useCallback)((e=>e.setBalloonState),[])),[v,I]=(0,o.useState)(T),[C,k]=(0,o.useState)(N),[,D]=(0,o.useState)(!1),[R,P]=(0,o.useState)(!1),B=(0,o.useRef)(null),j=(0,o.useRef)(null),O=(0,F.useFocused)(),H=(0,F.useSelected)();(0,o.useEffect)((()=>{var e,t;g.startsWith("data:")||(D(!0),(e=g,t=e=>{-1===e||requestAnimationFrame((()=>{j.current&&(j.current.style.width=`${e}%`)}))},new Promise(((n,o)=>{const r=new XMLHttpRequest;let l=!1;r.open("GET",e,!0),r.responseType="arraybuffer",r.onprogress=function(e){e.lengthComputable?t(e.loaded/e.total*100):l||(l=!0,t(-1))},r.onloadend=function(){if(r.status.toString().startsWith("2")){l||t(100);const e={},o=r.getAllResponseHeaders().match(/^content-type:\s*(.*?)$/im);o&&o[1]&&(e.type=o[1]);const i=new Blob([this.response],e);window.URL&&"function"==typeof window.URL.createObjectURL&&n(window.URL.createObjectURL(i))}else o(r)},r.send()}))).then((()=>{D(!1)}),(()=>{D(!1)})))}),[]),(0,o.useEffect)((()=>{I(T)}),[T]),(0,o.useEffect)((()=>{k(N)}),[N]);const U=(0,o.useCallback)(((e,t)=>{const n=F.ReactEditor.findPath(b,r);e===T?c.Transforms.select(b,n):((0,a.setNodes)(b,{width:e,height:t},{at:n}),M(A.CLOSE))}),[b,r,T]),K=(0,o.useCallback)((e=>{const t=F.ReactEditor.findPath(b,r);(0,a.setNodes)(b,{alt:encodeURIComponent(e.target.value),caption:[{text:encodeURIComponent(e.target.value)}]},{at:t})}),[b,r]),$=(0,o.useMemo)((()=>{const e=y||c.Node.string(_[0])||"";return decodeURIComponent(e)}),[_]);return(0,S.jsxs)(S.Fragment,{children:[R&&(0,S.jsxs)(rr.u_,{isOpen:R,size:"large",onClose:()=>{P(!1)},"data-testid":"test-image-modal",children:[(0,S.jsx)(rr.xB,{heading:$||""}),(0,S.jsx)(rr.hz,{children:(0,S.jsx)(Io.Z,{direction:"column",alignItems:"normal",children:(0,S.jsx)("img",{src:g,alt:$,width:v,height:C,onClick:()=>P(!0)})})})]}),(0,S.jsxs)("figure",(0,x.Z)({},t,m,l,{id:f,className:i()("image-element",{focused:O,selected:H}),onClick:()=>{!L&&!(()=>{var e;const t=`mimir-${b.id}`,n=null==(e=document.getElementById(t))?void 0:e.classList;return null==n?void 0:n.contains("edit-mode")})()&&P(!0)},"data-testid":"test-image-figure-element",children:[(0,S.jsx)("div",{contentEditable:"false",className:"image-wrapper",children:g.startsWith("data:")?(0,S.jsxs)("div",{className:"image-loader image-loader-data",children:[(0,S.jsx)("img",{src:g,className:"image-loader-preview"}),(0,S.jsx)(dr,{className:"image-loader-indicator"})]}):(0,S.jsxs)(ur.Resizable,(0,x.Z)({size:{width:v,height:"auto"},maxWidth:"100%",lockAspectRatio:!0,resizeRatio:"center"===u?2:1,className:"image-resize",enable:{left:["center","left"].includes(u),right:["center","right"].includes(u)},handleComponent:{left:(0,o.createElement)("div",{className:"image-handle handle-left"}),right:(0,o.createElement)("div",{className:"image-handle handle-right"})},handleStyles:{right:{marginTop:0,right:0}},onResize:(e,t,n)=>{I(n.offsetWidth),k(n.offsetHeight)},onResizeStop:(e,t,n)=>U(n.offsetWidth,n.offsetHeight)},d,{children:[(0,S.jsx)("img",(0,x.Z)({ref:B,src:g,className:i()("image-item",{focused:O,selected:H}),alt:$,height:C,width:v,draggable:E},l)),!h&&($.length>0||H)&&(0,S.jsx)(mr(),{className:"image-caption",value:$,placeholder:p,onChange:K})]}))}),n]}))]})}));var fr=n(44645),gr=n(83125),Tr=n(38394),Nr=n(45261),yr=n(60398);const _r=r().memo((({lang:e="plain",onChange:t,className:n})=>{var r;const[l,i]=(0,o.useState)({value:e,label:null!=(r=a.CODE_BLOCK_LANGUAGES[e])?r:"Plain Text"}),s=(0,o.useMemo)((()=>Object.entries(a.CODE_BLOCK_LANGUAGES).map((([e,t])=>({value:e,label:t})))),[]),c=(0,o.useCallback)((e=>{t(e),i(e)}),[t]);return(0,S.jsx)(fr.Z,{onChange:c,options:s,value:l,isClearable:!1,isSearchable:!1,menuMaxHeight:130,placeholder:"Select option",className:n})})),Lr=e=>{const[t,n]=(0,o.useState)(!1),[r,l]=(0,o.useState)(!1),s=(0,o.useMemo)((()=>(0,yr.v4)()),[]),{attributes:c,children:d,element:u,nodeProps:E,editor:m}=e,{lang:p}=u,h=p?`${p} language-${p}`:"",f=(0,o.useCallback)((()=>{(e=>{if(!e)return;const t=document.querySelector("body"),n=document.createElement("textarea");t.append(n),n.value=e,n.focus(),n.select(),document.execCommand("copy",!1),document.execCommand("delete"),n.remove()})(document.querySelector(`.codeblock__code-${s}`).textContent),l(!0),setTimeout((()=>{l(!1)}),1500)}),[s]),g=(0,o.useCallback)((()=>{n((e=>!e))}),[]);return(0,S.jsxs)("div",(0,x.Z)({className:"slate-codeblock-wrapper"},c,E,{children:[(0,S.jsxs)("div",{className:"codeblock__header",children:[(0,S.jsx)("div",{className:"codeblock__header__left",children:(0,S.jsx)(_r,{lang:p,className:"codeblock__dropdown",onChange:({value:e})=>{const t=F.ReactEditor.findPath(m,u);t&&(0,a.setNodes)(m,{lang:e},{at:t})}})}),(0,S.jsxs)("div",{className:"codeblock__header__right",children:[(0,S.jsx)(Co.Z,{type:"tertiary",onClick:g,className:i()("codeblock__button",{"word-wrapped":t}),tooltip:"Wrap Lines",icon:(0,S.jsx)(gr.Z,{color:"content-color-primary"})}),(0,S.jsx)(Co.Z,{type:"tertiary",className:"codeblock__button",onClick:f,tooltip:r?"Copied":"Copy",icon:r?(0,S.jsx)(Tr.Z,{className:"code-copied"}):(0,S.jsx)(Nr.Z,{className:"code-copy"})})]})]}),(0,S.jsx)("pre",{className:"codeblock__content",children:(0,S.jsx)("code",{className:i()(`codeblock__code-${s}`,{"word-wrapped":t},h),children:d})})]}))},br=e=>{const{attributes:t,children:n,nodeProps:o}=e;return(0,S.jsx)("article",(0,x.Z)({},t,o,{children:n}))},Mr=e=>{const{attributes:t,children:n,nodeProps:o}=e;return(0,S.jsx)("abbr",(0,x.Z)({},t,o,{children:n}))},vr=e=>{const{attributes:t,children:n,nodeProps:o}=e;return(0,S.jsx)("address",(0,x.Z)({},t,o,{children:n}))},Ar=e=>{const{attributes:t,children:n,nodeProps:o}=e;return(0,S.jsx)("aside",(0,x.Z)({},t,o,{children:n}))},xr=({attributes:e,children:t,nodeProps:n})=>(0,S.jsx)("section",(0,x.Z)({},e,n,{children:t})),Ir=e=>{const{attributes:t,children:n,nodeProps:o}=e;return(0,S.jsx)("comment",(0,x.Z)({},t,o,{children:n}))},Cr=["attributes","children","element","nodeProps","caption","resizableProps","align","draggable"],kr=e=>{const{attributes:t,children:n,element:r,nodeProps:l,caption:s={},resizableProps:d={minWidth:100},align:u="center",draggable:E}=e,m=(0,Z.Z)(e,Cr),{placeholder:p="Add a caption...",disabled:h}=s,{id:f,url:g,width:T,height:N,alt:y="",caption:_=[{children:[{text:""}]}]}=r,L=(0,a.useEditorRef)(),b=w((0,o.useCallback)((e=>e.setBalloonState),[])),[M,v]=(0,o.useState)(T),[I,C]=(0,o.useState)(N),[k,D]=(0,o.useState)(!0),R=(0,o.useRef)(null),P=(0,F.useFocused)(),B=(0,F.useSelected)();(0,o.useEffect)((()=>{v(T)}),[T]),(0,o.useEffect)((()=>{C(N)}),[N]),(0,o.useEffect)((()=>{if(!k&&!I&&!M){const e=R.current,t=340,n=t/((null==e?void 0:e.offsetWidth)/(null==e?void 0:e.offsetHeight));v(t),C(n),j(t,n)}}),[k]);const j=(0,o.useCallback)(((e,t)=>{const n=F.ReactEditor.findPath(L,r);e===T?c.Transforms.select(L,n):((0,a.setNodes)(L,{width:e,height:t},{at:n}),b(A.CLOSE))}),[L,r,T]),O=(0,o.useCallback)((e=>{const t=F.ReactEditor.findPath(L,r);(0,a.setNodes)(L,{alt:encodeURIComponent(e.target.value),caption:[{text:encodeURIComponent(e.target.value)}]},{at:t})}),[L,r]),H=(0,o.useMemo)((()=>{const e=y||c.Node.string(_[0])||"";return decodeURIComponent(e)}),[_]),U=(0,o.useCallback)((()=>{D(!1)}),[]);return(0,S.jsxs)("figure",(0,x.Z)({},t,m,l,{id:f,className:i()("media-element",{focused:P,selected:B}),children:[(0,S.jsxs)("div",{direction:"column",contentEditable:"false",className:"media-plus-caption-wrapper",children:[k&&(0,S.jsx)("div",{className:"media-loader",style:{width:`${M}px`,height:`${I}px`},children:(0,S.jsx)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIyIiBoZWlnaHQ9IjkyIiB2aWV3Qm94PSIwIDAgMTIyIDkyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cmVjdCB4PSIwLjUiIHk9IjAuNSIgd2lkdGg9IjEyMSIgaGVpZ2h0PSI5MSIgcng9IjEuNSIgc3Ryb2tlPSIjQTZBNkE2Ii8+CjxyZWN0IHg9IjEwLjUiIHk9IjEwLjUiIHdpZHRoPSIxMDEiIGhlaWdodD0iNzEiIHJ4PSIxLjUiIHN0cm9rZT0iI0E2QTZBNiIvPgo8cGF0aCBkPSJNNzUgNDQuMjY3OUM3Ni4zMzMzIDQ1LjAzNzggNzYuMzMzMyA0Ni45NjIyIDc1IDQ3LjczMkw1NS41IDU4Ljk5MDRDNTQuMTY2NyA1OS43NjAyIDUyLjUgNTguNzk3OSA1Mi41IDU3LjI1ODNMNTIuNSAzNC43NDE3QzUyLjUgMzMuMjAyMSA1NC4xNjY3IDMyLjIzOTggNTUuNSAzMy4wMDk2TDc1IDQ0LjI2NzlaIiBmaWxsPSIjQTZBNkE2Ii8+Cjwvc3ZnPgo=",alt:"loading...",width:"150",height:"150"})}),(0,S.jsxs)(ur.Resizable,(0,x.Z)({maxWidth:"100%",lockAspectRatio:!0,resizeRatio:"center"===u?2:1,className:i()("media-resize",{iFrameLoading:k}),enable:{left:["center","left"].includes(u),right:["center","right"].includes(u)},handleComponent:{left:(0,o.createElement)("div",{className:"media-handle handle-left"}),right:(0,o.createElement)("div",{className:"media-handle handle-right"})},handleStyles:{right:{marginTop:0,right:0}},onResize:(e,t,n)=>{v(n.offsetWidth),C(n.offsetHeight)},onResizeStop:(e,t,n)=>j(n.offsetWidth,n.offsetHeight)},d,{children:[(0,S.jsx)("div",{contentEditable:"false",className:"media-wrapper",children:(0,S.jsx)("iframe",(0,x.Z)({ref:R,src:g,className:i()("media-item",{focused:P,selected:B}),alt:H,height:I,width:M,draggable:E,onLoad:U},l))}),!h&&(H.length>0||B)&&(0,S.jsx)(mr(),{className:"media-caption",value:H,placeholder:p,onChange:O})]}))]}),n]}))},Dr=({attributes:e,children:t,nodeProps:n,element:r})=>{const l=new RegExp(/^(https?)[\S\s]*$/),[i,s]=(0,o.useState)(!1);(0,o.useEffect)((()=>{var t;const n=null==(t=e.ref.current)?void 0:t.children;if(n)for(const e of n)"FIGURE"===e.tagName&&s(!0)}),[e]);let a=r.url;const c=a&&a.startsWith("#");return c||(a=l.test(a)?a:"https://"+a),(0,S.jsx)("a",(0,x.Z)({className:"link-element",href:a,rel:"noreferrer",target:c?"_self":"_blank",onClick:e=>{e.preventDefault(),i&&window&&window.open(a,"_blank")}},e,n,{children:t}))};function Rr({id:e,onChange:t,placeholder:n,autoFocus:r=!0,initialValue:l="",showToolbar:d=!0,isControlled:u=!1,context:E=Qe.WYSIWYG,inputFormat:m=Ye.MARKDOWN,mentionItems:p=[],renderMentionItem:f,isOffline:g,source:T,modelDetails:N,updateMediaUploadStatus:y,disableMediaUpload:_=!1,enableAutoSaveOnBlur:L=!1,isAPIAuthEditor:b=!1,readOnly:M=!1,onEditorHeightChange:v,showEditorToggle:x=!1,handleEditorToggle:I,spellCheck:C=!1,isEnvironmentResolutionEnabled:k=!1,isBigFontSize:D},R){const P=(0,o.useRef)(null),B=(0,o.useRef)(null),O=(0,o.useRef)(null),H=(0,o.useRef)(null),U=(0,o.useRef)(null),K=!0,Z=(0,o.useMemo)((()=>null!=e?e:(0,s.nanoid)(6)),[l]),F=(0,o.useMemo)((()=>E&&Qt[E].plugins),[]),$=(0,a.createPlateUI)({[a.ELEMENT_LINK]:Dr,[a.ELEMENT_IMAGE]:hr,[a.ELEMENT_MEDIA_EMBED]:kr,[a.ELEMENT_TABLE]:xo,[a.ELEMENT_CODE_BLOCK]:Lr,[Pt]:br,[St]:Mr,[Zt]:xr,[Ot]:vr,[Ut]:Ar,[$t]:Ir}),G=(0,o.useMemo)((()=>({placeholder:null!=n?n:Xe,autoFocus:r,spellCheck:C,readOnly:M,padding:"0 30px"})),[M]),[z,V]=(0,o.useState)(""),[q,W]=(0,o.useState)(""),[Y,Q]=(0,o.useState)(0),X=w((0,o.useCallback)((e=>e.nodeType),[])),J=w((0,o.useCallback)((e=>e.balloonState),[])),ee=w((0,o.useCallback)((e=>e.setBalloonState),[])),te=w((0,o.useCallback)((e=>e.setEditorSelection),[])),ne=w((0,o.useCallback)((e=>e.isMediaUploading),[]));(0,o.useEffect)((()=>{B.current=J}),[J]),(0,o.useEffect)((()=>{P.current=X}),[X]),(0,o.useEffect)((()=>(d&&L&&document.addEventListener("mousedown",de),()=>d&&L&&document.removeEventListener("mousedown",de))),[L,d]);const oe=b?Jt(P):Xt(P),re=eo(P,E,N,T,K,b),le=to(P,N,T,K),ie=no(K),se=oo(),ae=(0,a.createPluginFactory)({key:"event-editor",handlers:{onKeyDown:oe,onPaste:re,onDrop:le,onDragOver:ie,onDragEnter:se,onBlur:e=>()=>{e&&e.selection&&te(e.selection)},onScroll:e=>t=>{e.selection&&e.selection!==O.current?O.current=e.selection:(O.current=e.selection,B.current===A.CLOSE||"slate-table-wrapper"!==t.target.className&&"table"!==P.current?B.current!==A.CLOSE&&(c.Transforms.deselect(e),ee(A.CLOSE)):ee(A.CLOSE))}}}),ce=(0,o.useMemo)((()=>(0,a.createPlateEditor)({id:Z,plugins:[...F,ae()],components:$})),[Z]);function de(e){var n;const o=null==U||null==(n=U.current)?void 0:n.getBoundingClientRect(),r=e.clientX<(null==o?void 0:o.left)||e.clientX>(null==o?void 0:o.left)+(null==o?void 0:o.width),l=e.clientY<(null==o?void 0:o.top)||e.clientY>(null==o?void 0:o.top)+(null==o?void 0:o.height),i=null!==e.target.closest(".toolbar__anchor")||null!==e.target.closest(".toolbar__toggle")||null!==e.target.closest(".toolbar__dropdown")||null!==e.target.closest(".image-balloon-container")||null!==e.target.closest(".link-balloon-container")||null!==e.target.closest(".table-balloon-container")||null!==e.target.closest(".media-balloon-container");d&&L&&(r||l)&&!i&&(ee(A.CLOSE),"function"==typeof t&&t(z))}return(0,o.useEffect)((()=>{if(ce)switch(m){case Ye.MARKDOWN:{const e=h(l=xn(l),{gfm:!0}),t=vn(Ao(ce,e));if(V(t),k&&!1===d){const e=h(l=xn(l),{gfm:!0}),t=vn(Ao(ce,e));W(t)}break}case Ye.HTML:{const e=Ao(ce,l);V(e);break}case Ye.SLATE:V(l);break;default:throw new Error(`Input format not supported - ${m}`)}}),[ce,m,l,d]),(0,o.useEffect)((()=>{null!==ne&&"function"==typeof y&&y(ne)}),[ne]),(0,o.useImperativeHandle)(R,(()=>({slateToMD(e){const t=zn(ce,{nodes:null!=e?e:z});return vo(t)},mdToSlate(e,t=!0){t&&(e=xn(e));const n=h(e,{gfm:!0});return vn(Ao(ce,n))},rawValue:()=>z}))),(0,o.useEffect)((()=>{setTimeout((()=>{if(!H.current||!v)return;const e=new ResizeObserver((()=>{var e;const t=null==(e=H.current)?void 0:e.clientHeight;t&&requestAnimationFrame((()=>{v(t)}))}));return e.observe(H.current),()=>e.disconnect()}))}),[Z]),(0,S.jsx)(a.PlateProvider,{id:Z,children:(0,S.jsxs)("div",{className:i()({"edit-mode":d,"mimir mimir-small":D,mimir:!D}),ref:U,id:`mimir-${Z}`,"data-testId":"test-mimir-main",children:[(0,S.jsx)("div",{className:i()("toolbar__anchor",{hide:!d}),children:(0,S.jsx)(a.HeadingToolbar,{children:(0,S.jsx)(j,{isAPIAuthEditor:b,showEditorToggle:x,source:T,handleEditorToggle:I,editorId:Z,isVideoEmbedEnabled:!0})})}),(0,S.jsx)("div",{className:"editor__container",ref:H,children:(0,S.jsx)(a.Plate,{id:Z,editor:ce,plugins:F,components:$,value:k?d?z:q:z,editableProps:G,onChange:function(e){e[e.length-1].type===a.ELEMENT_DEFAULT||L||(e=[...e,me()]),u?"function"==typeof t&&t(e):(V(e),k&&!1===d&&W(e)),Q(Y+1)}})}),(0,S.jsx)(or,{editorId:Z,isOffline:g,source:T,isMediaUploadEnabled:!0,modelDetails:N})]},Z)})}const wr=(0,o.memo)((0,o.forwardRef)(Rr))}}]);
//# sourceMappingURL=9473.afffed2412edabd4.js.map