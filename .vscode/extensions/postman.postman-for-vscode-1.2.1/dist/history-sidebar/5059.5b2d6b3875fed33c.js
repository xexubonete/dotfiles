"use strict";(self.webpackChunkhistory_sidebar=self.webpackChunkhistory_sidebar||[]).push([[5059],{15059:(e,o,n)=>{n.r(o),n.d(o,{COLLECTION_RUNS_LIST_PREFIX:()=>u,COLLECTION_RUN_PREFIX:()=>l,collectionRunByIdQuery:()=>p,collectionRunsListQuery:()=>d,deleteCollectionRun:()=>y,fetchCollectionRunById:()=>I,findCollectionRuns:()=>a,getQueryKey:()=>i,importCollectionRun:()=>w,removeCollectionRunFromListCache:()=>T,useCollectionRunById:()=>k,useCollectionRuns:()=>R,useDeleteCollectionRun:()=>g,useDeleteRuns:()=>E});var s=n(7560),t=n(45860),r=n(26663),c=n.n(r);const a=async e=>{const{signal:o,workspaceId:n,collectionId:r,populateIterations:a,count:u,status:l,owner:i,source:d,since_id:I,max_id:p}=e;return await t.postmanGateway.get({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun`,query:(0,s.Z)({workspace:n},r&&{collection:r},{iterations:a||!1,count:u},l&&{status:l},i&&{owner:i},d&&{source:d},{since_id:I||0},p&&{max_id:p}),signal:o})},u="collection-runs-list",l="collection-run",i=e=>{const o=[u];for(const n of Object.values(e))n&&o.push(n);return o},d=({signal:e,workspaceId:o,collectionId:n,populateIterations:s=!1,count:t,status:r,owner:c,source:u,since_id:l=0,max_id:d=0})=>({queryKey:i({workspaceId:o,collectionId:n}),queryFn:()=>a({signal:e,workspaceId:o,collectionId:n,populateIterations:s,count:t,status:r,owner:c,source:u,since_id:l,max_id:d}),enabled:!!o,useErrorBoundary:!1}),I=async({signal:e,runId:o})=>await t.postmanGateway.get({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/${o}`,signal:e}),p=({signal:e,runId:o})=>({queryKey:[l,o],queryFn:()=>I({signal:e,runId:o}),enabled:!!o,useErrorBoundary:!1}),w=async({signal:e,owner:o,workspace:n,runDetails:s})=>await t.postmanGateway.post({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/import`,query:{owner:o,workspace:n},body:JSON.stringify(s),signal:e}),y=async({runId:e,userId:o,signal:n})=>await t.postmanGateway.delete({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/${e}`,query:{owner:o},signal:n});var _=n(97201);const R=({workspaceId:e,collectionId:o,count:n,status:s,source:t,owner:r})=>(0,_.useDataFetch)(d({workspaceId:e,collectionId:o,count:n,status:s,source:t,owner:r})),k=e=>(0,_.useDataFetch)(p({runId:e})),T=(e,o,n)=>{e&&(0,_.updateCache)({key:i({workspaceId:o,collectionId:null!=n?n:""}),updater:o=>o?o.filter((o=>o.model_id!==e)):o})},g=()=>(0,_.useMutation)({mutationFn:e=>y({runId:e.runId,userId:e.userId,signal:e.signal}),onSuccess:(e,o)=>{T(o.runId,o.workspaceId,o.collectionId),o.onSuccess&&o.onSuccess(e)},onError:(e,o)=>{o.onError&&o.onError(e)}});var m=n(53186),C=n(10099);const E=(e,o)=>{const n=(0,C.useActiveWorkspaceId)(),{userCanDeleteHistory:s}=(0,m.useWorkspacePermissions)(n),t=g(),{data:r}=R({workspaceId:n,count:e});return{deleteRuns:e=>{if(!s||!r)return;const c=r.map((e=>t.mutateAsync({runId:e.data.id,userId:e.data.owner,workspaceId:n,collectionId:o})));Promise.all(c).catch((o=>{e&&e(o)}))}}}}}]);
//# sourceMappingURL=5059.5b2d6b3875fed33c.js.map