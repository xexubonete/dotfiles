"use strict";(self.webpackChunkworkbench_import_entity=self.webpackChunkworkbench_import_entity||[]).push([[5650],{30869:(t,e,r)=>{r.d(e,{Z:()=>i});var a=r(56880),o=r(53186),n=r(10099),s=r(97504);const i=()=>{const t=(0,n.useActiveWorkspaceId)(),e=(0,o.useCreateNewCollection)(),r=(0,o.useWorkspacePermissions)(t);return async(o,n)=>{if(!r.userCanCreate)return{status:"error",description:"You do not have permission to import a collection."};const i=await(0,s.z)(n,o.name,"collection");if("cancel"===i)return{status:"error",description:"Import cancelled"};o.name=i;try{return await e.mutateAsync({workspaceId:t,requestBody:o}),a.AnalyticsService.addEventV2({category:"http-collection",action:"create",label:"import",value:1}),{status:"success",description:"Collection imported successfully."}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import collection. Please try again."}}}}},14162:(t,e,r)=>{r.d(e,{Z:()=>c});var a=r(98276),o=r(56880),n=r(10099),s=r(97201),i=r(97504);const c=()=>{const t=(0,n.useActiveWorkspaceId)(),e=(0,a.useCreateNewEnvironment)(),{data:r}=(0,s.useDataFetch)((0,a.getEnvironmentSidebarPermissionsQuery)(t));return async(a,n)=>{if(null==r||!r.userCanCreateEnvironment)return{status:"error",description:"You do not have permission to import an environment."};const s=await(0,i.z)(n,a.name,"environment");if("cancel"===s)return{status:"error",description:"Import cancelled"};a.name=s;try{return await e.mutateAsync({workspaceId:t,requestBody:a}),o.AnalyticsService.addEventV2({category:"environment",action:"create",label:"import"}),{status:"success",description:"Environment imported successfully."}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import environment. Please try again."}}}}},97504:(t,e,r)=>{r.d(e,{z:()=>n});var a=r(26246),o=r(98276);const n=async(t,e,r)=>{let n=!1;const s=t?t.map((t=>(t.name===e&&(n=!0),t.name))):[];if(n){const t=a.Modals.getModals(),n=await t.showWarningDialog({uid:`${r}-import-duplicate-warning`,subject:"",message:`${"collection"===r?"A collection":"An environment"} ${e} already exists. What would you like to do?`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Import as Copy",isPrimary:!0}]});return n&&"Import as Copy"===n.title?(0,o.getDuplicateEntityName)(s,e):"cancel"}return e}},25650:(t,e,r)=>{r.r(e),r.d(e,{default:()=>a.Z});var a=r(61983)},8123:(t,e,r)=>{r.d(e,{n:()=>n});var a=r(21466),o=r(13101);const n=async t=>{{const e=await a.VSCodeCommunicationsService.postMessageToExtensionAsPromise({type:"IMPORT_FILE",payload:{fileDetails:t,userId:(0,o.getUserId)()}});if(e.err)throw new Error(e.val.message);return e.val}}},61983:(t,e,r)=>{r.d(e,{Z:()=>A});var a=r(7560),o=r(40540),n=r(58560),s=r(16085),i=r(28377),c=r(80605),l=r(35736),u=r(81397),d=r(74962),p=r(35482),m=r(38394),y=r(32054),g=r(59530),h=r.n(g),f=r(91246),w=r(53186),v=r(98276),C=r(10099),I=r(30869),b=r(14162),x=r(39245),k=r(8123),Z=r(52322);const N=h()(n.Z).withConfig({displayName:"workbench-import-entity__ImportListContainer",componentId:"sc-90lswp-0"})(["margin-top:var(--spacing-l);margin-left:var(--spacing-l);margin-right:var(--spacing-l);flex-direction:column;"]),S=h()(s.Z).withConfig({displayName:"workbench-import-entity__SearchContainer",componentId:"sc-90lswp-1"})(["margin:var(--spacing-xl);"]),j=h()(i.Z).withConfig({displayName:"workbench-import-entity__StyledTable",componentId:"sc-90lswp-2"})(["padding-left:var(--spacing-xl);padding-right:var(--spacing-xl);"]),E=h()(n.Z).withConfig({displayName:"workbench-import-entity__Footer",componentId:"sc-90lswp-3"})(["margin-right:var(--spacing-xl);margin-top:var(--spacing-xl);"]),_=h()(c.Z).withConfig({displayName:"workbench-import-entity__StyledButton",componentId:"sc-90lswp-4"})([":disabled{background-color:var(--button-primary-background-color) !important;color:var(--button-primary-content-color) !important;opacity:0.5;}"]),A=()=>{var t;const e=(0,f.Z)(),[r,n]=(0,o.useState)(""),{setTabTitle:s}=(0,x.useTabTitleMeta)();(0,o.useEffect)((()=>{s("Import","import")}),[s]);const[i,g]=(0,o.useState)(null!=(t=e.data)?t:[]),[h,A]=(0,o.useState)((0,a.Z)({},i.map((()=>!0)))),[T,O]=(0,o.useState)(!1),W=(0,C.useActiveWorkspaceId)(),{data:P}=(0,w.useCollectionList)({workspaceId:W}),{data:D}=(0,v.useEnvironmentItems)({workspaceId:W}),L=(0,I.Z)(),F=(0,b.Z)(),M=T?[{id:"status",accessor:"status",cellWidth:"2%",Cell:({value:t})=>{if(t){if(t.isLoading)return(0,Z.jsx)(l.Z,{});if(t.error)return(0,Z.jsx)(u.Z,{content:t.error,children:(0,Z.jsx)(p.Z,{"data-testid":"import-status-icon",color:"content-color-error"})});if(t.success)return(0,Z.jsx)(u.Z,{content:"Imported successfully",children:(0,Z.jsx)(m.Z,{"data-testid":"import-status-icon",color:"content-color-success"})})}return null}},{Header:"Name",accessor:"name",cellWidth:"40%"},{Header:"Import As",accessor:"format",cellWidth:"40%"},{id:"action",accessor:"status",cellWidth:"5%",Cell:t=>{const e=t.row.original;return e.status&&e.status.error?(0,Z.jsx)(c.Z,{onClick:()=>q(e),type:"plain",text:"Retry"}):null}}]:[{Header:"Name",accessor:"name"},{Header:"Import As",accessor:"format"}],V=(t,e)=>{const r=[...i],a=r.find((e=>e.path===t));a&&(a.status=e),g(r)},q=async t=>{let e={isLoading:!0};V(t.path,e);try{const r=await(0,k.n)(t),a="postman_collection"===r.type?await L(r.data,null!=P?P:[]):await F(r.data,null!=D?D:[]);"error"===a.status&&(e={isLoading:!1,error:a.description}),"success"===a.status&&(e={isLoading:!1,success:!0})}catch(t){e={isLoading:!1,error:t.message}}finally{V(t.path,e)}};return(0,o.useEffect)((()=>{if(T)for(const t of i)q(t)}),[T]),(0,Z.jsxs)(N,{"data-testid":"import-list-container",children:[(0,Z.jsx)(d.Z,{type:"h3",text:`Import Elements (${i.length})`}),(0,Z.jsx)(S,{type:"search",value:r,onClear:()=>n(""),onChange:t=>{n(t.target.value)},placeholder:"Search for a file",width:"40%",prefix:(0,Z.jsx)(y.Z,{})}),(0,Z.jsx)(j,{data:i,columns:M,globalFilter:{filter:r},rowSelected:T?{}:{onSelect:t=>A(t),initialSelectionState:h}}),(0,Z.jsx)(E,{justifyContent:"flex-end",children:T?(0,Z.jsx)(Z.Fragment,{}):(0,Z.jsx)(_,{onClick:async()=>{const t=[];for(const e of Object.keys(h))t.push(i[Number(e)]);g(t),O(!0)},type:"primary",text:"Import","data-testid":"import-btn",isDisabled:0===Object.keys(h).length})})]})}},91246:(t,e,r)=>{r.d(e,{Z:()=>o});var a=r(32234);const o=()=>{if(window.NAVIGATION_CONTEXT){const e=JSON.parse(window.NAVIGATION_CONTEXT);try{var t;return JSON.parse(a.Base64.decode(null==e||null==(t=e.options)?void 0:t.importData))}catch(t){return{}}}return{}}}}]);
//# sourceMappingURL=5650.c6e88c175750da95.js.map